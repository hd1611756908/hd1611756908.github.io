<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hd1611756908.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="123456作者: 夜泊1990企鹅: 1611756908鹅群: 948233848邮箱: hd1611756908@163.com博客: https:&#x2F;&#x2F;hd1611756908.github.io&#x2F;B 站: https:&#x2F;&#x2F;space.bilibili.com&#x2F;514155929&#x2F;  第一章 mybatis简介1.1 mybatis的历史1231. mybatis在2010年前叫ibatis">
<meta property="og:type" content="article">
<meta property="og:title" content="MyBatis快速入门">
<meta property="og:url" content="https://hd1611756908.github.io/2024/07/02/mybatis3.4.6%E6%8A%80%E6%9C%AF%E5%85%A8%E6%94%BB%E7%95%A5%E6%8C%87%E5%8D%97(%E6%96%B0%E5%A2%9Ejson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%99%A8)/index.html">
<meta property="og:site_name" content="枫桥夜泊">
<meta property="og:description" content="123456作者: 夜泊1990企鹅: 1611756908鹅群: 948233848邮箱: hd1611756908@163.com博客: https:&#x2F;&#x2F;hd1611756908.github.io&#x2F;B 站: https:&#x2F;&#x2F;space.bilibili.com&#x2F;514155929&#x2F;  第一章 mybatis简介1.1 mybatis的历史1231. mybatis在2010年前叫ibatis">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/WEB558b8aae7b33719d29689ea0648dca2e?method=download&shareKey=233b9c7c99b2612638c88c52061f043e">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/WEB7d9d44efa80e645e97bbd41d9105bc41?method=download&shareKey=9f119b142aabb8b438dd325416ea6936">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/WEB061a19c5a3b7c0baf087a7f31875166b?method=download&shareKey=7abb9dc3097d16ffccb6aa0933aa3366">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/WEB97fa1dc4f8a1dcc94a08daae823d9e75?method=download&shareKey=9a4f41817d4838c0c28ee393539cb357">
<meta property="og:image" content="https://note.youdao.com/yws/api/personal/file/WEB0da056304be34fd2b0a5e355f7e1ff55?method=download&shareKey=a6a05b0000575db0118d831edcd955bb">
<meta property="article:published_time" content="2024-07-02T13:37:11.962Z">
<meta property="article:modified_time" content="2024-07-02T13:43:01.028Z">
<meta property="article:author" content="夜泊1990">
<meta property="article:tag" content="MyBatis">
<meta property="article:tag" content="jdbc">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="MySql">
<meta property="article:tag" content="动态SQL">
<meta property="article:tag" content="批量操作">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://note.youdao.com/yws/api/personal/file/WEB558b8aae7b33719d29689ea0648dca2e?method=download&shareKey=233b9c7c99b2612638c88c52061f043e">

<link rel="canonical" href="https://hd1611756908.github.io/2024/07/02/mybatis3.4.6%E6%8A%80%E6%9C%AF%E5%85%A8%E6%94%BB%E7%95%A5%E6%8C%87%E5%8D%97(%E6%96%B0%E5%A2%9Ejson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%99%A8)/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MyBatis快速入门 | 枫桥夜泊</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="枫桥夜泊" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">枫桥夜泊</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">每走一步,都是进步</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://gitee.com/ukoko" class="github-corner" title="Follow me on GitEE" aria-label="Follow me on GitEE" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hd1611756908.github.io/2024/07/02/mybatis3.4.6%E6%8A%80%E6%9C%AF%E5%85%A8%E6%94%BB%E7%95%A5%E6%8C%87%E5%8D%97(%E6%96%B0%E5%A2%9Ejson%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%99%A8)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="夜泊1990">
      <meta itemprop="description" content="俱往矣,要多呲花,有多呲花">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="枫桥夜泊">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MyBatis快速入门
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-07-02 21:37:11 / 修改时间：21:43:01" itemprop="dateCreated datePublished" datetime="2024-07-02T21:37:11+08:00">2024-07-02</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index"><span itemprop="name">mybatis</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>62k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>56 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">作者: 夜泊1990</span><br><span class="line">企鹅: 1611756908</span><br><span class="line">鹅群: 948233848</span><br><span class="line">邮箱: hd1611756908@163.com</span><br><span class="line">博客: https://hd1611756908.github.io/</span><br><span class="line">B 站: https://space.bilibili.com/514155929/</span><br></pre></td></tr></table></figure>

<h2 id="第一章-mybatis简介"><a href="#第一章-mybatis简介" class="headerlink" title="第一章 mybatis简介"></a>第一章 mybatis简介</h2><h3 id="1-1-mybatis的历史"><a href="#1-1-mybatis的历史" class="headerlink" title="1.1 mybatis的历史"></a>1.1 mybatis的历史</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. mybatis在2010年前叫ibatis是apache内部的一个项目，名字来源于internet+ibatis 是一个基于Java的持久层框架</span><br><span class="line">2. 2010年以后从apache内部迁移到google code上，并且改名为mybatis</span><br><span class="line">3. 2013年迁移到github上</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h3 id="1-2-mybatis是什么"><a href="#1-2-mybatis是什么" class="headerlink" title="1.2 mybatis是什么"></a>1.2 mybatis是什么</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 是一款优秀的持久层框架</span><br><span class="line">2. 支持定制化sql，存储过程以及高级映射</span><br><span class="line">3. 可以避免几乎所有的JDBC代码手动设置参数以及获取结果集</span><br><span class="line">4. 可以使用简单的 XML 或注解来配置和映射原生信息</span><br><span class="line">5. 用接口将Java 的 POJOs(Plain Old Java Objects,普通的 Java对象)映射成数据库中的记录</span><br></pre></td></tr></table></figure>
<h3 id="1-3-mybatis的优势"><a href="#1-3-mybatis的优势" class="headerlink" title="1.3 mybatis的优势"></a>1.3 mybatis的优势</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 相比于JDBC没有侵入性可以达到很好的解耦效果</span><br><span class="line">2. 相比于hibernate他有着高性能，可以满足当下绝大多数移动互联网时代的需求</span><br><span class="line">3. sql代码分类放置在不同的sql map中易维护</span><br></pre></td></tr></table></figure>
<h3 id="1-4-mybatis的核心文件编写"><a href="#1-4-mybatis的核心文件编写" class="headerlink" title="1.4 mybatis的核心文件编写"></a>1.4 mybatis的核心文件编写</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. POJO映射数据库表的Java对象</span><br><span class="line">2. data access objects(DAOS)映射器接口类，用于操作数据库</span><br><span class="line">3. sql maps : SQL映射配置文件,用于注册DAOs接口,使其接口有操作数据库的能力</span><br><span class="line">4. mybatis配置文件,初始化一些基本的配置信息,用于生成SqlSessionFactory</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="第二章-入门HelloWorld"><a href="#第二章-入门HelloWorld" class="headerlink" title="第二章 入门HelloWorld"></a>第二章 入门HelloWorld</h2><ul>
<li>数据库表创建<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//创建数据库</span><br><span class="line">CREATE DATABASE mybatis DEFAULT CHARACTER SET UTF8;</span><br><span class="line">//创建数据库表</span><br><span class="line">CREATE TABLE user(</span><br><span class="line">    `user_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `user_name` VARCHAR(100) NOT NULL COMMENT &#x27;用户名&#x27;,</span><br><span class="line">    `create_time` DATETIME DEFAULT NULL comment &#x27;创建时间&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;用户表&quot;;</span><br></pre></td></tr></table></figure></li>
<li>入门HelloWorld代码的编写<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">①创建项目,添加jar包</span><br><span class="line">    mybatis-3.4.6.jar</span><br><span class="line">    mysql-connector-java-5.1.7-bin.jar</span><br><span class="line">②根据官网的步骤一步步进行环境搭建.</span><br><span class="line">③使用junit测试进行接口的测试.</span><br></pre></td></tr></table></figure></li>
<li><ul>
<li>步骤</li>
</ul>
</li>
</ul>
<blockquote>
<p>第1步 创建映射数据库表的实体类</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 映射数据库表的接口类</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">import java.util.Date;</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line">	//用户ID</span><br><span class="line">	private Integer userId;</span><br><span class="line">	//用户名</span><br><span class="line">	private String userName;</span><br><span class="line">	//创建时间</span><br><span class="line">	private Date createTime;</span><br><span class="line"></span><br><span class="line">	public User() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	public User(Integer userId, String userName, Date createTime) &#123;</span><br><span class="line">		this.userId = userId;</span><br><span class="line">		this.userName = userName;</span><br><span class="line">		this.createTime = createTime;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第2步 创建操作数据库表的接口类</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 操作数据库表的接口</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 添加用户</span><br><span class="line">	 */</span><br><span class="line">	void addUser(User user);</span><br><span class="line">	/*</span><br><span class="line">	 * 删除用户</span><br><span class="line">	 */</span><br><span class="line">	void deleteUser(Integer userId);</span><br><span class="line">	/*</span><br><span class="line">	 * 更新用户</span><br><span class="line">	 */</span><br><span class="line">	void updateUser(User user);</span><br><span class="line">	/*</span><br><span class="line">	 * 通过用户ID获取用户信息</span><br><span class="line">	 */</span><br><span class="line">	User getUser(Integer userId);</span><br><span class="line">	/*</span><br><span class="line">	 * 获取用户列表</span><br><span class="line">	 */</span><br><span class="line">	List&lt;User&gt; getUsers();</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 根据名字模糊查询获取用户列表</span><br><span class="line">	 */</span><br><span class="line">	List&lt;User&gt; getUsersLikeByUserName(@Param(&quot;userName&quot;) String userName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第3步 创建注册操作数据库接口类的映射文件</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">操作数据库只能用SQL语句,但是mybatis提供了使用接口操作数据库,一般情况接口是没有操作数据库的能力的,但是 mybatis可以通过这个配置文件来注册接口，让接口有操作数据库的能力</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.im.mapper.UserMapper&quot;&gt;</span><br><span class="line">	&lt;!-- </span><br><span class="line">		此配置文件用来注册UserMapper这个接口以及此接口中定义的方法</span><br><span class="line">		namespace: 被注册接口的全类名</span><br><span class="line">		insert: 插入数据的标签,还有其他三个标签 查询select、更新update、删除delete</span><br><span class="line">		id: 接口里面定义的方法名字</span><br><span class="line">		parameterType: 方法的入参类型(全类名)</span><br><span class="line">		#&#123;xxx&#125;: 表达式  :  取方法的参数值</span><br><span class="line">				如果方法的入参是基本数据类型那么xxx为形参名</span><br><span class="line">				如果方法的入参为对象类型那么xxx为对象类型里面的属性名</span><br><span class="line">		resultType:方法的返回值类型</span><br><span class="line">		useGeneratedKeys: 让 myabtis 框架使用JDBC 通过 getGeneratedKeys 获取数据库主键.</span><br><span class="line">		keyProperty: 映射通过getGeneratedKeys获取的键值</span><br><span class="line">	 --&gt;</span><br><span class="line">	 &lt;insert id=&quot;addUser&quot; parameterType=&quot;com.im.entity.User&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;userId&quot;&gt;</span><br><span class="line">	 	INSERT INTO user(user_name,create_time) VALUES(#&#123;userName&#125;,#&#123;createTime&#125;)</span><br><span class="line">	 &lt;/insert&gt;</span><br><span class="line">	 </span><br><span class="line">	 &lt;delete id=&quot;deleteUser&quot; parameterType=&quot;Integer&quot;&gt;</span><br><span class="line">	 	DELETE FROM user WHERE user_id=#&#123;userId&#125;</span><br><span class="line">	 &lt;/delete&gt;</span><br><span class="line">	 </span><br><span class="line">	 &lt;update id=&quot;updateUser&quot; parameterType=&quot;com.im.entity.User&quot;&gt;</span><br><span class="line">	 	UPDATE user SET user_name=#&#123;userName&#125;,create_time=#&#123;createTime&#125; WHERE user_id=#&#123;userId&#125;</span><br><span class="line">	 &lt;/update&gt;</span><br><span class="line">	 </span><br><span class="line">	 &lt;select id=&quot;getUser&quot; parameterType=&quot;Integer&quot; resultType=&quot;com.im.entity.User&quot;&gt;</span><br><span class="line">	 	SELECT user_id as userId,user_name as userName,create_time as createTime FROM user WHERE user_id=#&#123;userId&#125;</span><br><span class="line">	 &lt;/select&gt;</span><br><span class="line">	 </span><br><span class="line">	 &lt;select id=&quot;getUsers&quot; resultType=&quot;com.im.entity.User&quot;&gt;</span><br><span class="line">	 	SELECT user_id as userId,user_name as userName,create_time as createTime FROM user</span><br><span class="line">	 &lt;/select&gt;</span><br><span class="line">	 &lt;!-- </span><br><span class="line">	  	构建LIKE参数</span><br><span class="line">	  	方式一: CONCAT(&#x27;参数1&#x27;,&#x27;参数2&#x27;,&#x27;参数3&#x27;) </span><br><span class="line">	  	方式二: 在传参数时构建成 %李雷%</span><br><span class="line">	  	方式三: 使用bind标签创建元素,放到上下文中</span><br><span class="line">	  --&gt;</span><br><span class="line">	 &lt;select id=&quot;getUsersLikeByUserName&quot; resultType=&quot;com.sc.entity.User&quot;&gt;</span><br><span class="line">	  	SELECT user_id as userId,user_name as userName,create_time as createTime FROM user WHERE user_name like CONCAT(&#x27;%&#x27;,#&#123;userName&#125;,&#x27;%&#x27;)</span><br><span class="line">	 &lt;/select&gt;</span><br><span class="line">	 &lt;select id=&quot;getUsersLikeByUserName&quot; resultType=&quot;com.sc.entity.User&quot;&gt;</span><br><span class="line">	  	SELECT user_id as userId,user_name as userName,create_time as createTime FROM user WHERE user_name like #&#123;userName&#125;</span><br><span class="line">	 &lt;/select&gt;</span><br><span class="line">	 </span><br><span class="line">	 &lt;select id=&quot;getUsersLikeByUserName&quot; resultType=&quot;com.sc.entity.User&quot;&gt;</span><br><span class="line">	  	&lt;bind name=&quot;pattern&quot; value=&quot;&#x27;%&#x27; + _parameter.userName + &#x27;%&#x27;&quot; /&gt;</span><br><span class="line">	  	SELECT user_id as userId,user_name as userName,create_time as createTime FROM user WHERE user_name like #&#123;pattern&#125;</span><br><span class="line">	 &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>第4步 创建mybatis核心配置文件 mybatis-config.xml,用于生成mybatis核心对象</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">    &lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">      &lt;transactionManager type=&quot;JDBC&quot;/&gt;</span><br><span class="line">      &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">      	&lt;!-- 数据库驱动 --&gt;</span><br><span class="line">        &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;</span><br><span class="line">        &lt;!-- mysql数据库地址 --&gt;</span><br><span class="line">        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&quot;/&gt;</span><br><span class="line">        &lt;!-- 数据库用户名 --&gt;</span><br><span class="line">        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">        &lt;!-- 数据库密码 --&gt;</span><br><span class="line">        &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">      &lt;/dataSource&gt;</span><br><span class="line">    &lt;/environment&gt;</span><br><span class="line">  &lt;/environments&gt;</span><br><span class="line">  &lt;mappers&gt;</span><br><span class="line">  	&lt;!-- 将注册接口的配置文件注册到mybatis的核心配置文件中,这是jar包版本,如果是maven项目，要放在resources文件夹下 --&gt;</span><br><span class="line">    &lt;mapper resource=&quot;com/im/mapper/UserMapper.xml&quot;/&gt;</span><br><span class="line">  &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第5步 通过单元测试类调用接口测试(mybatis原生API版调用)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">public class UserMapperTest1 &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 添加用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testAddUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//创建statement</span><br><span class="line">		String statement = &quot;com.im.mapper.UserMapper.addUser&quot;;</span><br><span class="line">		//构建入参</span><br><span class="line">		User user = new User();</span><br><span class="line">		user.setUserName(&quot;Tom&quot;);</span><br><span class="line">		user.setCreateTime(new Date());</span><br><span class="line">		int row = session.insert(statement, user);</span><br><span class="line">		System.out.println(&quot;row:&quot;+row);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 删除用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testDeleteUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//创建statement</span><br><span class="line">		String statement = &quot;com.im.mapper.UserMapper.deleteUser&quot;;</span><br><span class="line">		//调用mybatis的删除数据的API </span><br><span class="line">		int row = session.delete(statement, 1);</span><br><span class="line">		System.out.println(&quot;row:&quot;+row);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 更新用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testUpdateUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//创建statement</span><br><span class="line">		String statement = &quot;com.im.mapper.UserMapper.updateUser&quot;;</span><br><span class="line">		//调用mybatis的更新数据的API </span><br><span class="line">		//构建更新入参</span><br><span class="line">		User user = new User(2, &quot;polly&quot;, new Date());</span><br><span class="line">		int row = session.update(statement, user);</span><br><span class="line">		System.out.println(&quot;row:&quot;+row);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 根据ID获取用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//创建statement</span><br><span class="line">		String statement = &quot;com.im.mapper.UserMapper.getUser&quot;;</span><br><span class="line">		//调用mybatis的查询单个数据的API </span><br><span class="line">		User user = session.selectOne(statement, 2);</span><br><span class="line">		System.out.println(&quot;user:&quot;+user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 获取用户列表</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//创建statement</span><br><span class="line">		String statement = &quot;com.im.mapper.UserMapper.getUsers&quot;;</span><br><span class="line">		//调用mybatis的查询列表数据的API </span><br><span class="line">		List&lt;User&gt; list = session.selectList(statement);</span><br><span class="line">		System.out.println(&quot;users:&quot;+list);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第6步 通过单元测试类调用接口测试(mybatis映射器版调用)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line">public class UserMapperTest2 &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 添加用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testAddUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		User user = new User();</span><br><span class="line">		user.setUserName(&quot;张三&quot;);</span><br><span class="line">		user.setCreateTime(new Date());</span><br><span class="line">		//调用添加用户方法</span><br><span class="line">		userMapper.addUser(user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 删除用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testDeleteUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//调用删除方法</span><br><span class="line">		userMapper.deleteUser(2);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 更新用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testUpdateUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建更新入参</span><br><span class="line">		User user = new User(2, &quot;polly&quot;, new Date());</span><br><span class="line">		//调用更新方法</span><br><span class="line">		userMapper.updateUser(user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 根据ID获取用户</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//调用查询方法</span><br><span class="line">		User user = userMapper.getUser(3);</span><br><span class="line">		System.out.println(&quot;user:&quot;+user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 获取用户列表</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//调用查询全部方法</span><br><span class="line">		List&lt;User&gt; users = userMapper.getUsers();</span><br><span class="line">		System.out.println(&quot;users:&quot;+users);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="第三章-mybatis常用属性配置"><a href="#第三章-mybatis常用属性配置" class="headerlink" title="第三章 mybatis常用属性配置"></a>第三章 mybatis常用属性配置</h2><ul>
<li>properties:导入外部属性资源文件，解决数据库配置信息写到Java代码中的问题<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties resource=&quot;db.properties&quot;&gt;&lt;/properties&gt;</span><br><span class="line">&lt;environments default=&quot;development&quot;&gt;</span><br><span class="line">	&lt;environment id=&quot;development&quot;&gt;</span><br><span class="line">		&lt;transactionManager type=&quot;JDBC&quot; /&gt;</span><br><span class="line">		&lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">			&lt;!-- 数据库驱动 --&gt;</span><br><span class="line">			&lt;property name=&quot;driver&quot; value=&quot;$&#123;jdbc_driver&#125;&quot; /&gt;</span><br><span class="line">			&lt;!-- mysql数据库地址 --&gt;</span><br><span class="line">			&lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc_url&#125;&quot; /&gt;</span><br><span class="line">			&lt;!-- 数据库用户名 --&gt;</span><br><span class="line">			&lt;property name=&quot;username&quot; value=&quot;$&#123;user&#125;&quot; /&gt;</span><br><span class="line">			&lt;!-- 数据库密码 --&gt;</span><br><span class="line">			&lt;property name=&quot;password&quot; value=&quot;$&#123;password&#125;&quot; /&gt;</span><br><span class="line">		&lt;/dataSource&gt;</span><br><span class="line">	&lt;/environment&gt;</span><br><span class="line">&lt;/environments&gt;</span><br></pre></td></tr></table></figure></li>
<li>typeAliases: 解决别名的问题<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在mybatis-config.xml配置文件中配置别名</span><br><span class="line"></span><br><span class="line">&lt;!-- 别名设置 --&gt;</span><br><span class="line">&lt;typeAliases&gt;</span><br><span class="line">	&lt;!-- 将全类名 com.im.entity.User 映射成别名 user --&gt;</span><br><span class="line">	&lt;!-- 单个设置 --&gt;</span><br><span class="line">	&lt;!-- &lt;typeAlias type=&quot;com.im.entity.User&quot; alias=&quot;user&quot;/&gt; --&gt;</span><br><span class="line">	&lt;!-- 多个设置，将放在com.im.entity包下的所有Javabean都设置别名 --&gt;</span><br><span class="line">	&lt;package name=&quot;com.im.entity&quot;/&gt;</span><br><span class="line">&lt;/typeAliases&gt;</span><br></pre></td></tr></table></figure>
<center></li>
</ul>
<img src="https://note.youdao.com/yws/api/personal/file/WEB558b8aae7b33719d29689ea0648dca2e?method=download&shareKey=233b9c7c99b2612638c88c52061f043e">

</center>

<ul>
<li>setting: mybatis的一些常用配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">在mybatis-config.xml配置文件中配置一些mybatis的基本属性</span><br><span class="line"></span><br><span class="line">&lt;settings&gt;</span><br><span class="line">  &lt;!-- 二级缓存开启 默认开启 --&gt;</span><br><span class="line">  &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;!-- 懒加载 默认值 false --&gt;</span><br><span class="line">  &lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;!-- 即时加载 默认是false (true in ≤3.4.1)在3.4.1版本以前默认值为true --&gt;</span><br><span class="line">  &lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">  &lt;!-- 数据库经典列名和Java经典列名的映射（默认值为false） --&gt;</span><br><span class="line">  &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">&lt;/settings&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mapUnderscoreToCamelCase:简单介绍一下此属性的使用,其他的属性会在后面一一介绍。</span><br><span class="line"></span><br><span class="line">在日常Java开发中我们的命名规则驼峰状比如: aaaBbbCcc</span><br><span class="line">而我们的数据库命名规则为: AAA_BBB_CCC，因为命名规则</span><br><span class="line">的不同，在进行Java POJO和数据库表关系映射时，通过反射</span><br><span class="line">就会出现名称对应不上出现属性找不到数据为空的问题,解决方式一般有两种</span><br><span class="line">- ①通过SQL的设置别名</span><br><span class="line">- ②设置mapUnderscoreToCamelCase属性为true </span><br><span class="line">    </span><br><span class="line">第一种方式我们上面已经用过，接下来我们使用mybatis提供的配置方式解决这个问题,但是一定要注意数据库的命名和Java的命名，一定要遵循自己的命名规范</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<center>

<img src="https://note.youdao.com/yws/api/personal/file/WEB7d9d44efa80e645e97bbd41d9105bc41?method=download&shareKey=9f119b142aabb8b438dd325416ea6936">

</center>

<ul>
<li>mappers: 映射文件的配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在mybatis-config.xml配置文件中配置</span><br><span class="line"></span><br><span class="line">&lt;mappers&gt;</span><br><span class="line">	&lt;!-- 将注册接口的配置文件注册到mybatis的核心配置文件中，</span><br><span class="line">	     如果有多个映射文件,可以配置多个,还有其他方式会在后面介</span><br><span class="line">	     绍 --&gt;</span><br><span class="line">	&lt;mapper resource=&quot;com/im/mapper/UserMapper1.xml&quot; /&gt;</span><br><span class="line">	&lt;mapper resource=&quot;com/im/mapper/UserMapper2.xml&quot; /&gt;</span><br><span class="line">	&lt;mapper resource=&quot;com/im/mapper/UserMapper3.xml&quot; /&gt;</span><br><span class="line">&lt;/mappers&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第四章-映射枚举类型"><a href="#第四章-映射枚举类型" class="headerlink" title="第四章 映射枚举类型"></a>第四章 映射枚举类型</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">映射枚举的时候比较特殊,mybatis官方给我们提供了将枚举映射成字符串或者整数类型两种方式.看下面的实现方式.</span><br></pre></td></tr></table></figure>
<ul>
<li>表设计<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">数据库表的SQL语句</span><br><span class="line"></span><br><span class="line">CREATE TABLE student(</span><br><span class="line">    `stu_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `stu_name` VARCHAR(100) NOT NULL COMMENT &#x27;学生名&#x27;,</span><br><span class="line">    `gender1` INT NOT NULL COMMENT &#x27;性别整数类型&#x27;,</span><br><span class="line">    `gender2` VARCHAR(10) NOT NULL COMMENT &#x27;性别字符类型&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;学生表&quot;;</span><br></pre></td></tr></table></figure></li>
<li>映射数据库表的实体类<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 性别的枚举类</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public enum Gender &#123;</span><br><span class="line">	MAN(&quot;男&quot;), </span><br><span class="line">	WOMAN(&quot;女&quot;),</span><br><span class="line">	NEUTRAL(&quot;中性&quot;);</span><br><span class="line">	private String sex;</span><br><span class="line">	private Gender(String sex) &#123;</span><br><span class="line">		this.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getSex() &#123;</span><br><span class="line">		return sex;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setSex(String sex) &#123;</span><br><span class="line">		this.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;------------------分隔线-----------------------&gt;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 	映射数据库student表的类</span><br><span class="line"> *  @author hu shuang</span><br><span class="line"> *  @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public class Student &#123;</span><br><span class="line">	private Integer stuId;</span><br><span class="line">	private String stuName;</span><br><span class="line">	//性别映射数据库整数类型</span><br><span class="line">	private Gender gender1;</span><br><span class="line">	//性别映射数据库字符类型</span><br><span class="line">	private Gender gender2;</span><br><span class="line">	public Student() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>操作学生表的映射器接口<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> *  操作学生表的映射器接口</span><br><span class="line"> *	@author hu shuang</span><br><span class="line"> *  @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public interface StudentMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 添加一个学生</span><br><span class="line">	 */</span><br><span class="line">	void addStudent(Student student);</span><br><span class="line">	/*</span><br><span class="line">	 * 更新一个学生</span><br><span class="line">	 */</span><br><span class="line">	void updateStudent(Student student);</span><br><span class="line">	/*</span><br><span class="line">	 * 获取学生列表</span><br><span class="line">	 */</span><br><span class="line">	List&lt;Student&gt; getStudents();</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>注册接口的xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">注册接口的xml配置文件</span><br><span class="line"></span><br><span class="line">&lt;mapper namespace=&quot;com.im.mapper.StudentMapper&quot;&gt;</span><br><span class="line">	&lt;!-- </span><br><span class="line">		1、Java枚举值映射到数据库表里面的整型字段时，映射的是枚举的数组下标值</span><br><span class="line">		   使用typeHandler=&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot;</span><br><span class="line">		2、Java枚举值映射到数据库表里面的varchar类型字段时,使用typeHandler=&quot;org.apache.ibatis.type.EnumTypeHandler&quot;</span><br><span class="line">	--&gt;</span><br><span class="line">	&lt;insert id=&quot;addStudent&quot; parameterType=&quot;student&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;stuId&quot;&gt;</span><br><span class="line">		INSERT INTO student(stu_name,gender1,gender2) VALUES(#&#123;stuName&#125;,</span><br><span class="line">		#&#123;gender1,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler&#125;,</span><br><span class="line">		#&#123;gender2,typeHandler=org.apache.ibatis.type.EnumTypeHandler&#125;)</span><br><span class="line">	&lt;/insert&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 查询带有枚举类型的数据时，返回值结果类型不能使用resultType属性设置，需要使用resultMap属性重新进行映射 --&gt;</span><br><span class="line">	&lt;resultMap type=&quot;student&quot; id=&quot;studentMap&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;stuId&quot; column=&quot;stu_id&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;stuName&quot; column=&quot;stu_name&quot;/&gt;</span><br><span class="line">		&lt;!-- 映射下标 --&gt;</span><br><span class="line">		&lt;result property=&quot;gender1&quot; column=&quot;gender1&quot; typeHandler=&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot;/&gt;</span><br><span class="line">		&lt;!-- 映射字符串 --&gt;</span><br><span class="line">		&lt;result property=&quot;gender2&quot; column=&quot;gender2&quot; typeHandler=&quot;org.apache.ibatis.type.EnumTypeHandler&quot;/&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	&lt;select id=&quot;getStudents&quot; resultMap=&quot;studentMap&quot;&gt;</span><br><span class="line">		SELECT * FROM student</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- 更新枚举类型 --&gt;</span><br><span class="line">	&lt;update id=&quot;updateStudent&quot; parameterType=&quot;student&quot;&gt;</span><br><span class="line">		UPDATE student SET stu_name=#&#123;stuName&#125;,gender1=#&#123;gender1,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler&#125;,gender2=#&#123;gender2,typeHandler=org.apache.ibatis.type.EnumTypeHandler&#125; WHERE stu_id=#&#123;stuId&#125;</span><br><span class="line">	&lt;/update&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></li>
<li>测试枚举类型的增改查<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 测试枚举类型的增删改</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email  hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public class StudentMapperTest &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 添加学生</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testAddStudent() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		StudentMapper mapper = session.getMapper(StudentMapper.class);</span><br><span class="line">		Student student = new Student();</span><br><span class="line">		student.setStuName(&quot;韩梅梅&quot;);</span><br><span class="line">		student.setGender1(Gender.MAN);</span><br><span class="line">		student.setGender2(Gender.MAN);</span><br><span class="line">		mapper.addStudent(student);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	/*</span><br><span class="line">	 * 获取学生列表</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetStudents() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		StudentMapper mapper = session.getMapper(StudentMapper.class);</span><br><span class="line">		List&lt;Student&gt; students = mapper.getStudents();</span><br><span class="line">		System.out.println(students);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 更新学生信息</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testUpdateStudent() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		StudentMapper mapper = session.getMapper(StudentMapper.class);</span><br><span class="line">		Student student = new Student();</span><br><span class="line">		student.setStuId(1001);</span><br><span class="line">		student.setStuName(&quot;polly&quot;);</span><br><span class="line">		student.setGender1(Gender.WOMAN);</span><br><span class="line">		student.setGender2(Gender.WOMAN);</span><br><span class="line">		mapper.updateStudent(student);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第五章-SQL-map-注解-方式进行数据库操作"><a href="#第五章-SQL-map-注解-方式进行数据库操作" class="headerlink" title="第五章 SQL map(注解) 方式进行数据库操作"></a>第五章 SQL map(注解) 方式进行数据库操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">注解方式操作数据库:</span><br><span class="line"></span><br><span class="line">1. 不需要注册接口的xml配置文件</span><br><span class="line">2. 直接将SQL写到操作数据库的接口里的每一个方法上</span><br><span class="line">3. 核心配置文件 mapper 直接配置类</span><br><span class="line">&lt;mappers&gt;</span><br><span class="line">	&lt;!-- 将注册接口的配置文件注册到mybatis的核心配置文件中 --&gt;</span><br><span class="line">	&lt;mapper class=&quot;com.im.mapper.UserMapper&quot;/&gt;</span><br><span class="line">&lt;/mappers&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>操作数据库的接口<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 操作数据库表的接口</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 添加用户</span><br><span class="line">	 */</span><br><span class="line">	@Insert(&quot;INSERT INTO user(user_name,create_time) VALUES(#&#123;userName&#125;,#&#123;createTime&#125;)&quot;)</span><br><span class="line">	public void addUser(User user);</span><br><span class="line">	/*</span><br><span class="line">	 * 删除用户</span><br><span class="line">	 */</span><br><span class="line">	@Delete(&quot;DELETE FROM user WHERE user_id=#&#123;userId&#125;&quot;)</span><br><span class="line">	void deleteUser(Integer userId);</span><br><span class="line">	/*</span><br><span class="line">	 * 更新用户</span><br><span class="line">	 */</span><br><span class="line">	@Update(&quot;UPDATE user SET user_name=#&#123;userName&#125;,create_time=#&#123;createTime&#125; WHERE user_id=#&#123;userId&#125;&quot;)</span><br><span class="line">	void updateUser(User user);</span><br><span class="line">	/*</span><br><span class="line">	 * 通过用户ID获取用户信息</span><br><span class="line">	 */</span><br><span class="line">	@Select(&quot;SELECT * FROM user WHERE user_id=#&#123;userId&#125;&quot;)</span><br><span class="line">	User getUser(Integer userId);</span><br><span class="line">	/*</span><br><span class="line">	 * 获取用户列表</span><br><span class="line">	 */</span><br><span class="line">	@Select(&quot;SELECT * FROM user&quot;)</span><br><span class="line">	List&lt;User&gt; getUsers();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>单元测试类<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">public class UserMapperTest &#123;</span><br><span class="line"></span><br><span class="line">	@Test</span><br><span class="line">	public void testAddUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		User user = new User();</span><br><span class="line">		user.setUserName(&quot;张三&quot;);</span><br><span class="line">		user.setCreateTime(new Date());</span><br><span class="line">		mapper.addUser(user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testDeleteUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		mapper.deleteUser(2);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testUpdateUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		User user = new User();</span><br><span class="line">		user.setUserId(5);</span><br><span class="line">		user.setUserName(&quot;JIM&quot;);</span><br><span class="line">		user.setCreateTime(new Date());</span><br><span class="line">		mapper.updateUser(user);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">		List&lt;User&gt; users = mapper.getUsers();</span><br><span class="line">		System.out.println(users);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第六章-mybatis的日志功能"><a href="#第六章-mybatis的日志功能" class="headerlink" title="第六章 mybatis的日志功能"></a>第六章 mybatis的日志功能</h2><h3 id="6-1-日志的介绍"><a href="#6-1-日志的介绍" class="headerlink" title="6.1 日志的介绍"></a>6.1 日志的介绍</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mybatis内置日志工厂提供日志功能，内置日志工厂将日志交给以下其中一种工具做代理:</span><br><span class="line"></span><br><span class="line">1. SLF4J</span><br><span class="line">2. Apache Commons Logging</span><br><span class="line">3. Log4j 2</span><br><span class="line">4. Log4j</span><br><span class="line">5. JDK logging</span><br><span class="line"></span><br><span class="line">mybatis 内置日志工厂基于运行时自省机制选择合适的日志工具。它会使用第一个查找得到的工具（按上文列举的顺序查找）。如果一个都未找到，日志功能就会被禁用。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="6-2-日志配置"><a href="#6-2-日志配置" class="headerlink" title="6.2 日志配置"></a>6.2 日志配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">不少应用服务器（如 Tomcat 和 WebShpere）的类路径中已经包含 Commons Logging，所以在这种配置环境下的MyBatis会把它作为日志工具，记住这点非常重要。这将意味着，在诸如 WebSphere 的环境中，它提供了 Commons Logging的私有实现，你的Log4J配置将被忽略。MyBatis将你的Log4J配置忽略掉是相当令人郁闷的（事实上，正是因为在这种配置环境下，MyBatis 才会选择使用 Commons Logging而不是Log4J）。如果你的应用部署在一个类路径已经包含 Commons Logging 的环境中，而你又想使用其它日志工具，你可以通过在 MyBatis 配置文件mybatis-config.xml里面添加一项setting 来选择别的日志工具。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;settings&gt;</span><br><span class="line">    ...</span><br><span class="line">    &lt;setting name=&quot;logImpl&quot; value=&quot;LOG4J&quot;/&gt;</span><br><span class="line">    ...</span><br><span class="line">  &lt;/settings&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">logImpl 可选的值有：SLF4J、LOG4J、LOG4J2、JDK_LOGGING、COMMONS_LOGGING、STDOUT_LOGGING、NO_LOGGING，或者是实现了接口org.apache.ibatis.logging.Log的，且构造方法是以字符串为参数的类的完全限定名。</span><br><span class="line">(译者注：可以参考org.apache.ibatis.logging.slf4j.Slf4jImpl.java的实现)</span><br></pre></td></tr></table></figure>
<h3 id="6-3-日志的使用"><a href="#6-3-日志的使用" class="headerlink" title="6.3 日志的使用"></a>6.3 日志的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">第1步: 添加jar包</span><br><span class="line"></span><br><span class="line">log4j-1.2.17.jar</span><br><span class="line">slf4j-api-1.7.25.jar</span><br><span class="line">slf4j-log4j12-1.7.25.jar</span><br><span class="line"></span><br><span class="line">第2步: 添加日志配置文件log4j.xml</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;</span><br><span class="line">&lt;log4j:configuration</span><br><span class="line">	xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;</span><br><span class="line">	&lt;appender name=&quot;STDOUT&quot;</span><br><span class="line">		class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;</span><br><span class="line">		&lt;param name=&quot;Encoding&quot; value=&quot;UTF-8&quot; /&gt;</span><br><span class="line">		&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;ConversionPattern&quot;</span><br><span class="line">				value=&quot;%-5p %d&#123;MM-dd HH:mm:ss,SSS&#125; %m  (%F:%L) \n&quot; /&gt;</span><br><span class="line">		&lt;/layout&gt;</span><br><span class="line">	&lt;/appender&gt;</span><br><span class="line">	&lt;logger name=&quot;java.sql&quot;&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">	&lt;/logger&gt;</span><br><span class="line">	&lt;logger name=&quot;org.apache.ibatis&quot;&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">	&lt;/logger&gt;</span><br><span class="line">	&lt;root&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">		&lt;appender-ref ref=&quot;STDOUT&quot; /&gt;</span><br><span class="line">	&lt;/root&gt;</span><br><span class="line">&lt;/log4j:configuration&gt;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="第七章-动态SQL"><a href="#第七章-动态SQL" class="headerlink" title="第七章 动态SQL"></a>第七章 动态SQL</h2><h3 id="7-1-动态SQL简介"><a href="#7-1-动态SQL简介" class="headerlink" title="7.1 动态SQL简介"></a>7.1 动态SQL简介</h3><ul>
<li>动态SQL优势<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mybatis的强⼤特性之一就是动态sql,有过根据不同条件拼接SQL经历的同学应该知道当条件多的时候拼接SQL是一件很痛苦的事情，但是mybatis却很好的帮我们解决了拼接SQL的烦恼</span><br></pre></td></tr></table></figure></li>
<li>动态SQL所涉及到的标签<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. if</span><br><span class="line">2. choose(when,otherwise)(类似于我们Java中的switch语句)</span><br><span class="line">3. trim(where,set)</span><br><span class="line">4. foreach(多用于批量操作)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="7-2-动态SQL使用"><a href="#7-2-动态SQL使用" class="headerlink" title="7.2 动态SQL使用"></a>7.2 动态SQL使用</h3><h4 id="7-2-1-if语句-用于where子句之后作为条件判断"><a href="#7-2-1-if语句-用于where子句之后作为条件判断" class="headerlink" title="7.2.1 if语句(用于where子句之后作为条件判断)"></a>7.2.1 if语句(用于where子句之后作为条件判断)</h4><ul>
<li>使用常量(1&#x3D;1)解决由于部分条件匹配而产生的多AND造成SQL语法错误的问题<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- if可以作为条件判断 并且使用 1=1 来解决由于条件不匹配而产生的多AND造成SQL语法错误的问题 --&gt;</span><br><span class="line">&lt;select id=&quot;getBooks&quot; parameterType=&quot;book&quot; resultType=&quot;book&quot;&gt;</span><br><span class="line">	SELECT * FROM book WHERE 1=1</span><br><span class="line">	&lt;if test=&quot;bookName!=null&quot;&gt;AND book_name=#&#123;bookName&#125;&lt;/if&gt;</span><br><span class="line">	&lt;if test=&quot;author!=null and author.name!=null&quot;&gt;AND author_name=#&#123;author.name&#125;&lt;/if&gt;</span><br><span class="line">	&lt;if test=&quot;price!=null&quot;&gt;AND price=#&#123;price&#125;&lt;/if&gt; </span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<center>

<img src="https://note.youdao.com/yws/api/personal/file/WEB061a19c5a3b7c0baf087a7f31875166b?method=download&shareKey=7abb9dc3097d16ffccb6aa0933aa3366">

</center>


<ul>
<li>使用<where>标签解决由于部分条件匹配而产生的多AND造成SQL语法错误的问题<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- if可以作为条件判断 并且使用&lt;where&gt;标签来解决由于条件不匹配而产生的多AND造成SQL语法错误的问题 --&gt;</span><br><span class="line">&lt;select id=&quot;getBooks&quot; parameterType=&quot;book&quot; resultType=&quot;book&quot;&gt;</span><br><span class="line">	SELECT * FROM book</span><br><span class="line">	&lt;where&gt;</span><br><span class="line">		&lt;if test=&quot;bookName!=null&quot;&gt;AND book_name=#&#123;bookName&#125;&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;author!=null and author.name!=null&quot;&gt;AND author_name=#&#123;author.name&#125;&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;price!=null&quot;&gt;AND price=#&#123;price&#125;&lt;/if&gt; </span><br><span class="line">	&lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<center>

<img src="https://note.youdao.com/yws/api/personal/file/WEB97fa1dc4f8a1dcc94a08daae823d9e75?method=download&shareKey=9a4f41817d4838c0c28ee393539cb357">

</center>

<h4 id="7-2-2-if语句-用于更新语句作为入参判断"><a href="#7-2-2-if语句-用于更新语句作为入参判断" class="headerlink" title="7.2.2 if语句(用于更新语句作为入参判断)"></a>7.2.2 if语句(用于更新语句作为入参判断)</h4><ul>
<li>解决在增量更新时，因为不是所有字段都更新,所以有些字段没有赋值，造成的更新数据库某些数据被置空的为题<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;updateBook&quot; parameterType=&quot;book&quot;&gt;</span><br><span class="line">	UPDATE book SET </span><br><span class="line">	&lt;if test=&quot;bookNam!=null&quot;&gt;book_name=#&#123;bookName&#125;,&lt;/if&gt;</span><br><span class="line">	&lt;if test=&quot;author!=null and author.name!=null&quot;&gt;author_name=#&#123;author.name&#125;,&lt;/if&gt;</span><br><span class="line">	&lt;if test=&quot;price!=null&quot;&gt;price=#&#123;price&#125;&lt;/if&gt;</span><br><span class="line">	WHERE book_id=#&#123;bookId&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></li>
<li>注意事项<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在更新时，由于有些字段不需要更新而造成的SQL语句多逗号(,)问题</span><br></pre></td></tr></table></figure></li>
<li>解决方式(<set>标签)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;updateBook&quot; parameterType=&quot;book&quot;&gt;</span><br><span class="line">	UPDATE book </span><br><span class="line">	&lt;set&gt;</span><br><span class="line">		&lt;if test=&quot;bookNam!=null&quot;&gt;book_name=#&#123;bookName&#125;,&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;author!=null and author.name!=null&quot;&gt;author_name=#&#123;author.name&#125;,&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;price!=null&quot;&gt;price=#&#123;price&#125;&lt;/if&gt;</span><br><span class="line">	&lt;/set&gt;</span><br><span class="line">	WHERE book_id=#&#123;bookId&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<center>

<img src="https://note.youdao.com/yws/api/personal/file/WEB0da056304be34fd2b0a5e355f7e1ff55?method=download&shareKey=a6a05b0000575db0118d831edcd955bb">

</center>

<h4 id="7-2-3-choose-when-otherwise"><a href="#7-2-3-choose-when-otherwise" class="headerlink" title="7.2.3 choose (when, otherwise)"></a>7.2.3 choose (when, otherwise)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">用于匹配多个条件中的一个(不常用)</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;getBooks&quot; parameterType=&quot;book&quot; resultType=&quot;book&quot;&gt;</span><br><span class="line">	SELECT * FROM book WHERE</span><br><span class="line">	&lt;choose&gt;</span><br><span class="line">		&lt;when test=&quot;bookName!=null&quot;&gt;book_name=#&#123;bookName&#125;&lt;/when&gt;</span><br><span class="line">		&lt;when test=&quot;author!=null and author.name!=null&quot;&gt;author_name=#&#123;author.name&#125;&lt;/when&gt;</span><br><span class="line">		&lt;when test=&quot;price!=null&quot;&gt;price=#&#123;price&#125;&lt;/when&gt;</span><br><span class="line">		&lt;otherwise&gt;</span><br><span class="line">			book_id=#&#123;bookId&#125;</span><br><span class="line">		&lt;/otherwise&gt;</span><br><span class="line">	&lt;/choose&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<h4 id="7-2-4-foreach-多用于批量操作"><a href="#7-2-4-foreach-多用于批量操作" class="headerlink" title="7.2.4 foreach(多用于批量操作)"></a>7.2.4 foreach(多用于批量操作)</h4><ul>
<li>批量操作Mapper层接口<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 操作数据库表的接口</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 批量添加</span><br><span class="line">	 */</span><br><span class="line">	//void batchAddUser(List&lt;User&gt; users); //根据类型匹配</span><br><span class="line">	void batchAddUser(@Param(&quot;users&quot;) List&lt;User&gt; users);//根据名称匹配</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 批量查询</span><br><span class="line">	 */</span><br><span class="line">	void batchQueryUsers(List&lt;Integer&gt; ids);</span><br><span class="line">	/*</span><br><span class="line">	 * 批量删除</span><br><span class="line">	 */</span><br><span class="line">	void batchDeleteUsers(List&lt;Integer&gt; ids);</span><br><span class="line">	/*</span><br><span class="line">	 * 批量更新</span><br><span class="line">	 */</span><br><span class="line">	void batchUpdateUsers(List&lt;User&gt; users);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>批量添加语法</li>
<li><ul>
<li>方式一<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">方式一:</span><br><span class="line"> &lt;!-- 批量添加 --&gt;</span><br><span class="line"> &lt;!-- 根据类型匹配 --&gt;</span><br><span class="line"> &lt;insert id=&quot;batchAddUser&quot; parameterType=&quot;user&quot;&gt;</span><br><span class="line"> 	INSERT INTO user(user_name,create_time) VALUES </span><br><span class="line"> 	&lt;foreach collection=&quot;list&quot; item=&quot;item&quot;  separator=&quot;,&quot; &gt;</span><br><span class="line"> 		(#&#123;item.userName&#125;,#&#123;item.createTime&#125;)</span><br><span class="line"> 	&lt;/foreach&gt;</span><br><span class="line"> &lt;/insert&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><ul>
<li>方式二<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 根据名称匹配 --&gt;</span><br><span class="line"> &lt;insert id=&quot;batchAddUser&quot; parameterType=&quot;user&quot;&gt;</span><br><span class="line"> 	INSERT INTO user(user_name,create_time) VALUES </span><br><span class="line"> 	&lt;foreach collection=&quot;users&quot; item=&quot;item&quot;  separator=&quot;,&quot; &gt;</span><br><span class="line"> 		(#&#123;item.userName&#125;,#&#123;item.createTime&#125;)</span><br><span class="line"> 	&lt;/foreach&gt;</span><br><span class="line"> &lt;/insert&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>批量查询语法<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 批量查询 --&gt;</span><br><span class="line"> &lt;select id=&quot;batchQueryUsers&quot; resultType=&quot;user&quot;&gt;</span><br><span class="line"> 	SELECT * FROM user WHERE user_id IN </span><br><span class="line"> 	&lt;foreach collection=&quot;list&quot; item=&quot;item&quot; open=&quot;(&quot; close=&quot;)&quot; separator=&quot;,&quot;&gt;</span><br><span class="line"> 		#&#123;item&#125;</span><br><span class="line"> 	&lt;/foreach&gt;</span><br><span class="line"> &lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
<li>批量删除语法<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 批量删除 --&gt;</span><br><span class="line">&lt;delete id=&quot;batchDeleteUsers&quot;&gt;</span><br><span class="line">	DELETE FROM user WHERE user_id IN </span><br><span class="line">	&lt;foreach collection=&quot;list&quot; item=&quot;id&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">		#&#123;id&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/delete&gt;</span><br></pre></td></tr></table></figure></li>
<li>批量更新语法</li>
<li><ul>
<li>批量更新配置<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用mybatis进行批量更新数据库数据时，需要在url地址后面加上allowMultiQueries参数等于true</span><br><span class="line">例如: jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8&amp;allowMultiQueries=true</span><br><span class="line">注意:在properties文件中使用&amp;号;在xml配置文件中使用&amp;amp;连接参数</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><ul>
<li>语法格式<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 批量更新 --&gt;</span><br><span class="line">&lt;update id=&quot;batchUpdateUsers&quot; parameterType=&quot;user&quot;&gt;</span><br><span class="line">	&lt;foreach collection=&quot;list&quot; item=&quot;item&quot;  open=&quot;&quot; separator=&quot;;&quot; close=&quot;&quot;&gt;</span><br><span class="line">		UPDATE user </span><br><span class="line">		&lt;set&gt;</span><br><span class="line">			&lt;if test=&quot;item.userName!=null&quot;&gt;user_name=#&#123;item.userName&#125;,&lt;/if&gt;</span><br><span class="line">			&lt;if test=&quot;item.createTime!=null&quot;&gt;create_time=#&#123;item.createTime&#125;&lt;/if&gt;</span><br><span class="line">		&lt;/set&gt;</span><br><span class="line">		WHERE user_id=#&#123;item.userId&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>单元测试代码<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line">public class UserMapperTest &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 批量添加</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testBatchAddUser() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		List&lt;User&gt; users = new ArrayList&lt;&gt;();</span><br><span class="line">		User user1 = new User(null, &quot;EEE&quot;, new Date());</span><br><span class="line">		User user2 = new User(null, &quot;FFF&quot;, new Date());</span><br><span class="line">		User user3 = new User(null, &quot;GGG&quot;, new Date());</span><br><span class="line">		User user4 = new User(null, &quot;HHH&quot;, new Date());</span><br><span class="line">		</span><br><span class="line">		users.add(user1);</span><br><span class="line">		users.add(user2);</span><br><span class="line">		users.add(user3);</span><br><span class="line">		users.add(user4);</span><br><span class="line">		</span><br><span class="line">		//调用添加用户方法</span><br><span class="line">		userMapper.batchAddUser(users);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 批量查询</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testBatchQueryUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		List&lt;Integer&gt; ids = new ArrayList&lt;&gt;();</span><br><span class="line">		</span><br><span class="line">		ids.add(3);</span><br><span class="line">		ids.add(5);</span><br><span class="line">		ids.add(7);</span><br><span class="line">		</span><br><span class="line">		//调用批量查询用户方法</span><br><span class="line">		List&lt;User&gt; users = userMapper.batchQueryUsers(ids);</span><br><span class="line">		System.out.println(users);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 批量删除</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testBatchDeleteUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		List&lt;Integer&gt; ids = new ArrayList&lt;&gt;();</span><br><span class="line">		</span><br><span class="line">		ids.add(3);</span><br><span class="line">		ids.add(5);</span><br><span class="line">		ids.add(7);</span><br><span class="line">		</span><br><span class="line">		//调用批量删除方法</span><br><span class="line">		userMapper.batchDeleteUsers(ids);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125; </span><br><span class="line">	/*</span><br><span class="line">	 * 批量更新</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testBatchUpdateUsers() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		//获取映射器类的对象实例</span><br><span class="line">		UserMapper userMapper = session.getMapper(UserMapper.class);</span><br><span class="line">		//构建入参</span><br><span class="line">		List&lt;User&gt; users = new ArrayList&lt;&gt;();</span><br><span class="line">		</span><br><span class="line">		User user1 = new User(4,&quot;MMM&quot;, new Date());</span><br><span class="line">		User user2 = new User(6,&quot;VVV&quot;, new Date());</span><br><span class="line">		User user3 = new User(8,&quot;WWW&quot;, new Date());</span><br><span class="line">		</span><br><span class="line">		users.add(user1);</span><br><span class="line">		users.add(user2);</span><br><span class="line">		users.add(user3);</span><br><span class="line">		</span><br><span class="line">		//调用批量更新方法</span><br><span class="line">		userMapper.batchUpdateUsers(users);</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第八章-高级查询"><a href="#第八章-高级查询" class="headerlink" title="第八章 高级查询"></a>第八章 高级查询</h2><h3 id="8-1-数据库表创建-部门表-x2F-员工表"><a href="#8-1-数据库表创建-部门表-x2F-员工表" class="headerlink" title="8.1 数据库表创建(部门表&#x2F;员工表)"></a>8.1 数据库表创建(部门表&#x2F;员工表)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE department(</span><br><span class="line">    `dept_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `dept_name` VARCHAR(20) NOT NULL COMMENT &#x27;部门名称&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;部门表&quot;;</span><br><span class="line"></span><br><span class="line">CREATE TABLE employee(</span><br><span class="line">    `emp_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `emp_name` VARCHAR(20) NOT NULL COMMENT &#x27;员工名称&#x27;,</span><br><span class="line">    `salary` DOUBLE(10,2) DEFAULT 0.00 COMMENT &#x27;工资&#x27;,</span><br><span class="line">    `dept_id` INT NOT NULL COMMENT &#x27;部门ID，关联部门表的主键&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;员工表&quot;;</span><br><span class="line"></span><br><span class="line">//关联</span><br><span class="line">ALTER TABLE employee ADD FOREIGN KEY(dept_id) REFERENCES department(dept_id);</span><br><span class="line"></span><br><span class="line">INSERT INTO department(dept_name) VALUES(&#x27;行政部&#x27;),(&#x27;人事部&#x27;),(&#x27;IT部&#x27;);</span><br><span class="line"></span><br><span class="line">INSERT INTO employee(emp_name,salary,dept_id) VALUES(&#x27;孙悟空&#x27;,100.12,1000),(&#x27;猪八戒&#x27;,100.12,1001),(&#x27;沙悟净&#x27;,100.12,1002);</span><br></pre></td></tr></table></figure>
<h3 id="8-2-创建映射数据库表的实体类"><a href="#8-2-创建映射数据库表的实体类" class="headerlink" title="8.2 创建映射数据库表的实体类"></a>8.2 创建映射数据库表的实体类</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 映射数据库部门表</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public class Department &#123;</span><br><span class="line">	private Integer deptId;</span><br><span class="line">	private String deptName;</span><br><span class="line">	// 一个部门下有多个员工(一对多关联)</span><br><span class="line">	private List&lt;Employee&gt; employees;</span><br><span class="line"></span><br><span class="line">	public Department() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 映射数据库员工表</span><br><span class="line"> * @author hu shuang</span><br><span class="line"> * @email hd1611756908@163.com</span><br><span class="line"> */</span><br><span class="line">public class Employee &#123;</span><br><span class="line"></span><br><span class="line">	private Integer empId;</span><br><span class="line">	private String empName;</span><br><span class="line">	private Double salary;</span><br><span class="line">	// 一个员工对应一个部门(一对一关联)</span><br><span class="line">	private Department department;</span><br><span class="line"></span><br><span class="line">	public Employee() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="8-3-创建操作数据库的映射器接口"><a href="#8-3-创建操作数据库的映射器接口" class="headerlink" title="8.3 创建操作数据库的映射器接口"></a>8.3 创建操作数据库的映射器接口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. (一对一)查询员工信息,将员工的部门信息同时查出(一个员工属于一个部门)</span><br><span class="line">2. (一对多)查询部门信息,将此部门下的所有员工信息都查询出来(一个部门下有多个员工)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public interface DepartmentMapper &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 根据部门ID查询部门详情,不需要将当前部门下的员工列表查出</span><br><span class="line">	 */</span><br><span class="line">	Department getDepartmentByDeptId(Integer deptId);</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 根据部门ID查询部门详情,需要将当前部门下的员工列表查询出来(方式一 一对多关联查询 单条SQL)</span><br><span class="line">	 */</span><br><span class="line">	Department getDepartmentByDeptId_(Integer deptId);</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 根据部门ID查询部门详情,需要将当前部门下的员工列表查询出来(方式二 一对多关联查询 多条SQL)</span><br><span class="line">	 */</span><br><span class="line">	Department getDepartmentByDeptId$(Integer deptId);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public interface EmployeeMapper &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 通过员工ID查询员工信息,同时查询出员工的部门信息( 方式一(单条SQL 关联查询) )</span><br><span class="line">	 */</span><br><span class="line">	Employee getEmployeeByEmpId(Integer empId);</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 通过员工ID查询员工信息,同时查询出员工的部门信息( 方式二(多条SQL查询) )</span><br><span class="line">	 */</span><br><span class="line">	Employee getEmployeeByEmpId_(Integer empId);</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 通过部门ID查询员工列表</span><br><span class="line">	 */</span><br><span class="line">	List&lt;Employee&gt; getEmployeesByDeptId(Integer deptId);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-4-创建注册接口的XML配置文件"><a href="#8-4-创建注册接口的XML配置文件" class="headerlink" title="8.4 创建注册接口的XML配置文件"></a>8.4 创建注册接口的XML配置文件</h3><ul>
<li>一对一(方式一)单条SQL关联查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">EmployeeMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;!-- 一对一 方式一(单条SQL 关联查询) --&gt;</span><br><span class="line">&lt;resultMap type=&quot;employee&quot; id=&quot;employeeMap&quot;&gt;</span><br><span class="line">	&lt;!-- 映射主键 --&gt;</span><br><span class="line">	&lt;id property=&quot;empId&quot; column=&quot;emp_id&quot;/&gt;</span><br><span class="line">	&lt;!-- 其他映射 --&gt;</span><br><span class="line">	&lt;result property=&quot;empName&quot; column=&quot;emp_name&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;salary&quot; column=&quot;salary&quot;/&gt;</span><br><span class="line">	&lt;!-- 使用 association 进行一对一关联查询 --&gt;</span><br><span class="line">	&lt;association property=&quot;department&quot; javaType=&quot;department&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;deptId&quot; column=&quot;dept_id&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;deptName&quot; column=&quot;dept_name&quot;/&gt;</span><br><span class="line">	&lt;/association&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=&quot;getEmployeeByEmpId&quot; parameterType=&quot;Integer&quot; resultMap=&quot;employeeMap&quot;&gt;</span><br><span class="line">	SELECT * FROM employee e,department d WHERE e.dept_id=d.dept_id AND e.emp_id=#&#123;empId&#125;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>一对一(方式二)多条SQL分别查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">EmployeeMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;!-- 一对一 方式二(多条SQL查询) --&gt;</span><br><span class="line">&lt;resultMap type=&quot;employee&quot; id=&quot;employeeMap_&quot;&gt;</span><br><span class="line">	&lt;id property=&quot;empId&quot; column=&quot;emp_id&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;empName&quot; column=&quot;emp_name&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;salary&quot; column=&quot;salary&quot;/&gt;</span><br><span class="line">	&lt;!-- </span><br><span class="line">		 当使用方式二时,association标签内有一个select属性,需要在此调用DepartmentMapper xml</span><br><span class="line">		 配置文件中的statement进行二次查询</span><br><span class="line">		 com.im.mapper.DepartmentMapper.getDepartmentByDeptId:DepartmentMapper.xml中的namespace(接口全类名)+id属性(方法名字)</span><br><span class="line">	--&gt;</span><br><span class="line">	&lt;association property=&quot;department&quot; javaType=&quot;department&quot; column=&quot;dept_id&quot; select=&quot;com.im.mapper.DepartmentMapper.getDepartmentByDeptId&quot;/&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=&quot;getEmployeeByEmpId_&quot; parameterType=&quot;Integer&quot; resultMap=&quot;employeeMap_&quot;&gt;</span><br><span class="line">	SELECT * FROM employee WHERE emp_id=#&#123;empId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DepartmentMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;getDepartmentByDeptId&quot; parameterType=&quot;Integer&quot; resultType=&quot;department&quot;&gt;</span><br><span class="line">	SELECT * FROM department WHERE dept_id=#&#123;deptId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
<li>一对多(方式一)单条SQL关联查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DepartmentMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;!-- 根据部门ID查询部门详情,需要将当前部门下的员工列表查询出来(方式一 一对多关联查询 单条SQL) --&gt;</span><br><span class="line">&lt;resultMap type=&quot;department&quot; id=&quot;departmentMap_&quot;&gt;</span><br><span class="line">	&lt;id property=&quot;deptId&quot; column=&quot;dept_id&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;deptName&quot; column=&quot;dept_name&quot;/&gt;</span><br><span class="line">	&lt;!-- 一对多关联查询多的一方使用collection标签 ofType:集合中的泛型类型;property:多的一方属性名 --&gt;</span><br><span class="line">	&lt;collection property=&quot;employees&quot; ofType=&quot;employee&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;empId&quot; column=&quot;emp_id&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;empName&quot; column=&quot;emp_name&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;salary&quot; column=&quot;salary&quot;/&gt;</span><br><span class="line">	&lt;/collection&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=&quot;getDepartmentByDeptId_&quot; parameterType=&quot;Integer&quot; resultMap=&quot;departmentMap_&quot;&gt;</span><br><span class="line">	SELECT * FROM department d,employee e WHERE d.dept_id=e.dept_id AND d.dept_id=#&#123;deptId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
<li>一对多(方式二)多条SQL分别查询<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DepartmentMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;!-- 根据部门ID查询部门详情,需要将当前部门下的员工列表查询出来(方式二 一对多关联查询 多条SQL) --&gt;</span><br><span class="line">&lt;resultMap type=&quot;department&quot; id=&quot;departmentMap$&quot;&gt;</span><br><span class="line">	&lt;id property=&quot;deptId&quot; column=&quot;dept_id&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;deptName&quot; column=&quot;dept_name&quot;/&gt;</span><br><span class="line">	&lt;!-- 一对多关联查询多的一方使用collection标签 ofType:集合中的泛型类型;property:多的一方属性名 column:关联关系的键 --&gt;</span><br><span class="line">	&lt;collection property=&quot;employees&quot; ofType=&quot;employee&quot; column=&quot;dept_id&quot; select=&quot;com.im.mapper.EmployeeMapper.getEmployeesByDeptId&quot;/&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=&quot;getDepartmentByDeptId$&quot; parameterType=&quot;Integer&quot; resultMap=&quot;departmentMap$&quot;&gt;</span><br><span class="line">	SELECT * FROM department WHERE dept_id=#&#123;deptId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EmployeeMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;getEmployeesByDeptId&quot; parameterType=&quot;Integer&quot; resultType=&quot;employee&quot;&gt;</span><br><span class="line">	SELECT * FROM employee WHERE dept_id=#&#123;deptId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="8-5-单元测试类"><a href="#8-5-单元测试类" class="headerlink" title="8.5 单元测试类"></a>8.5 单元测试类</h3><ul>
<li>EmployeeMapperTest.java<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">public class EmployeeMapperTest &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 一对一 方式一(使用一条SQL语句关联查询)</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetEmployeeByEmpId() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		EmployeeMapper employeeMapper = session.getMapper(EmployeeMapper.class);</span><br><span class="line">		Employee employee = employeeMapper.getEmployeeByEmpId(1000);</span><br><span class="line">		System.out.println(employee);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 一对一 方式二(多条SQL分别查询)</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetEmployeeByEmpId_() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		EmployeeMapper employeeMapper = session.getMapper(EmployeeMapper.class);</span><br><span class="line">		Employee employee = employeeMapper.getEmployeeByEmpId_(1000);</span><br><span class="line">		System.out.println(employee);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>DepartmentMapperTest.java<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public class DepartmentMapperTest &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 一对多 方式一(使用一条SQL语句关联查询)</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetDepartmentByDeptId_() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		DepartmentMapper mapper = session.getMapper(DepartmentMapper.class);</span><br><span class="line">		Department department = mapper.getDepartmentByDeptId_(1000);</span><br><span class="line">		System.out.println(department);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	/*</span><br><span class="line">	 * 一对多 方式二(多条SQL单独查询)</span><br><span class="line">	 */</span><br><span class="line">	@Test</span><br><span class="line">	public void testGetDepartmentByDeptId$() throws IOException &#123;</span><br><span class="line">		//加载外部属性资源文件</span><br><span class="line">		InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">		//创建SqlSessionFactory</span><br><span class="line">		SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">		//创建SqlSession</span><br><span class="line">		SqlSession session = sessionFactory.openSession();</span><br><span class="line">		</span><br><span class="line">		DepartmentMapper mapper = session.getMapper(DepartmentMapper.class);</span><br><span class="line">		Department department = mapper.getDepartmentByDeptId$(1000);</span><br><span class="line">		System.out.println(department);</span><br><span class="line">		</span><br><span class="line">		//提交</span><br><span class="line">		session.commit();</span><br><span class="line">		//关闭会话</span><br><span class="line">		session.close();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="8-6-关联查询bug扩展"><a href="#8-6-关联查询bug扩展" class="headerlink" title="8.6 关联查询bug扩展"></a>8.6 关联查询bug扩展</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于带有关联关系的多个POJO之间因为属性名相同问题而引起的映射数据出错的BUG处理以及解决方式</span><br></pre></td></tr></table></figure>
<ul>
<li>创建数据库表<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tb_key(</span><br><span class="line">    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `name` VARCHAR(20) NOT NULL COMMENT &#x27;钥匙名称&#x27;,</span><br><span class="line">    `lock_id` INT NOT NULL COMMENT &#x27;锁ID关联锁表的主键&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;钥匙表&quot;;</span><br><span class="line"></span><br><span class="line">CREATE TABLE tb_lock(</span><br><span class="line">    `id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT &#x27;主键&#x27;,</span><br><span class="line">    `name` VARCHAR(20) NOT NULL COMMENT &#x27;锁名称&#x27;</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT=&quot;锁表&quot;;</span><br><span class="line">//关联</span><br><span class="line">ALTER TABLE tb_key ADD FOREIGN KEY(lock_id) REFERENCES tb_lock(id);</span><br><span class="line"></span><br><span class="line">INSERT INTO tb_key(name,lock_id) VALUES(&quot;铁牛钥匙&quot;,1000);</span><br><span class="line">INSERT INTO tb_lock(name) VALUES(&#x27;铁牛锁&#x27;);</span><br></pre></td></tr></table></figure></li>
<li>创建映射数据库表的实体类<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 锁类</span><br><span class="line"> */</span><br><span class="line">public class TbLock &#123;</span><br><span class="line"></span><br><span class="line">	private Integer id;</span><br><span class="line">	private String name;</span><br><span class="line"></span><br><span class="line">	public TbLock() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 钥匙类</span><br><span class="line"> */</span><br><span class="line">public class TbKey &#123;</span><br><span class="line"></span><br><span class="line">	private Integer id;</span><br><span class="line">	private String name;</span><br><span class="line">	//一把钥匙只能开一把锁 一对一关联</span><br><span class="line">	private TbLock tbLock;</span><br><span class="line"></span><br><span class="line">	public TbKey() &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>创建操作数据库表的映射器接口<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface TbKeyMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 通过钥匙ID钥匙信息以及锁的信息</span><br><span class="line">	 */</span><br><span class="line">	TbKey getKeyInfo(Integer keyId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>创建注册操作数据库表接口的xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;mapper namespace=&quot;com.im.mapper.TbKeyMapper&quot;&gt;</span><br><span class="line">	&lt;resultMap type=&quot;tbKey&quot; id=&quot;tbKeyMap&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line">		&lt;association property=&quot;tbLock&quot; javaType=&quot;tbLock&quot;&gt;</span><br><span class="line">			&lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line">			&lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line">		&lt;/association&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	&lt;select id=&quot;getKeyInfo&quot; parameterType=&quot;Integer&quot; resultMap=&quot;tbKeyMap&quot;&gt;</span><br><span class="line">		SELECT * FROM tb_key tk,tb_lock tl WHERE tk.lock_id=tl.id AND tk.id=#&#123;keyId&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></li>
<li>编写测试类<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">public void testGetKeyInfo() throws IOException &#123;</span><br><span class="line">	//加载外部属性资源文件</span><br><span class="line">	InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">	//创建SqlSessionFactory</span><br><span class="line">	SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">	//创建SqlSession</span><br><span class="line">	SqlSession session = sessionFactory.openSession();</span><br><span class="line">	</span><br><span class="line">	TbKeyMapper keyMapper = session.getMapper(TbKeyMapper.class);</span><br><span class="line">	TbKey keyInfo = keyMapper.getKeyInfo(1000);</span><br><span class="line">	System.out.println(keyInfo);</span><br><span class="line">	</span><br><span class="line">	//提交</span><br><span class="line">	session.commit();</span><br><span class="line">	//关闭会话</span><br><span class="line">	session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>结果分析<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">得出的结果,会发现映射出错,钥匙和锁信息都是相同的</span><br><span class="line"></span><br><span class="line">TbKey [id=1000, name=铁牛钥匙, tbLock=TbLock [id=1000, name=铁牛钥匙]]</span><br><span class="line"></span><br><span class="line">造成以上问题的原因是因为TbKey和TbLock两个JavaBean类中的属性名字相同造成的,由此可以看出 association 标签映射Java对象时采用的是通过名称映射的,在两个JavaBean属性名字相同时，在映射时候就会出现映射不清的问题。</span><br></pre></td></tr></table></figure></li>
<li>解决方案: 采用多SQL联查的方式<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap type=&quot;tbKey&quot; id=&quot;tbKeyMap&quot;&gt;</span><br><span class="line">	&lt;id property=&quot;id&quot; column=&quot;id&quot;/&gt;</span><br><span class="line">	&lt;result property=&quot;name&quot; column=&quot;name&quot;/&gt;</span><br><span class="line">	&lt;association property=&quot;tbLock&quot; javaType=&quot;tbLock&quot; column=&quot;lock_id&quot; select=&quot;com.im.mapper.TbLockMapper.getLockInfo&quot;/&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line">&lt;select id=&quot;getKeyInfo&quot; parameterType=&quot;Integer&quot; resultMap=&quot;tbKeyMap&quot;&gt;</span><br><span class="line">	SELECT * FROM tb_key WHERE id=#&#123;keyId&#125;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第九章-mybatis的懒加载"><a href="#第九章-mybatis的懒加载" class="headerlink" title="第九章 mybatis的懒加载"></a>第九章 mybatis的懒加载</h2><h3 id="9-1-什么是懒加载"><a href="#9-1-什么是懒加载" class="headerlink" title="9.1 什么是懒加载"></a>9.1 什么是懒加载</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">懒加载又称延时加载，就是在我们获取数据时，有些数据是不需要实时获取的，当需要时在获取，这样的加载数据的方式被称为懒加载</span><br></pre></td></tr></table></figure>
<h3 id="9-2-懒加载的使用"><a href="#9-2-懒加载的使用" class="headerlink" title="9.2 懒加载的使用"></a>9.2 懒加载的使用</h3><ul>
<li>添加jar包如果是maven依赖,可以不加<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cglib-2.2.2.jar</span><br><span class="line">asm-3.3.1.jar</span><br></pre></td></tr></table></figure></li>
<li>在mybatis全局配置文件中开启懒加载<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">关闭及时加载 aggressiveLazyLoading</span><br><span class="line">开启懒加载 lazyLoadingEnabled</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;settings&gt;</span><br><span class="line">	&lt;!-- 设置经典Java命名规则和经典数据库命名规则的自动映射 --&gt;</span><br><span class="line">	&lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">	&lt;!-- 开启懒加载 --&gt;</span><br><span class="line">	&lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">	&lt;!-- 关闭延时加载 --&gt;</span><br><span class="line">	&lt;setting name=&quot;aggressiveLazyLoading&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure></li>
<li>特定关联关系中可通过设置fetchType属性来覆盖该项的开关状态<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 特定关联关系是指使用关联映射标签</span><br><span class="line">&lt;collection&gt;或者&lt;association&gt;中的select</span><br><span class="line">属性，而不是使用多表联查的方式.</span><br><span class="line">2. 可以通过&lt;collection&gt;或者&lt;association&gt;的fetchType属性设置成lazy</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第十章-mybatis的缓存"><a href="#第十章-mybatis的缓存" class="headerlink" title="第十章 mybatis的缓存"></a>第十章 mybatis的缓存</h2><h3 id="10-1-缓存的优缺点"><a href="#10-1-缓存的优缺点" class="headerlink" title="10.1 缓存的优缺点"></a>10.1 缓存的优缺点</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">优点: 减少读数据库的读操作,降低数据库压力,加快响应速度</span><br><span class="line">缺点:可能造成数据不一致问题,增加成本</span><br></pre></td></tr></table></figure>
<h3 id="10-2-mybatis的一级缓存"><a href="#10-2-mybatis的一级缓存" class="headerlink" title="10.2 mybatis的一级缓存"></a>10.2 mybatis的一级缓存</h3><ul>
<li>一级缓存特点<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 一级缓存默认是开启的</span><br><span class="line">2. 一级缓存默认是SqlSession级别的</span><br></pre></td></tr></table></figure></li>
<li>验证一级缓存<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 在一个SqlSession下根据相同条件多次查询,发现日志只打印一条SQL,说明有缓存存在</span><br><span class="line">2. 在多个SqlSession下,根据相同条件查询,打印多条SQL说明一级缓存是SqlSession级别的,创新创建SqlSession对象之后缓存失效</span><br></pre></td></tr></table></figure></li>
<li>一级缓存失效方式<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 使用sqlSession.clearCache()刷新缓存</span><br><span class="line">2. 关闭SqlSession之后重新打开</span><br><span class="line">3. SqlSession执行增删改之后会清空缓存</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="10-3-mybatis的二级缓存"><a href="#10-3-mybatis的二级缓存" class="headerlink" title="10.3 mybatis的二级缓存"></a>10.3 mybatis的二级缓存</h3><ul>
<li>二级缓存特点<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 二级缓存需要手动配置</span><br><span class="line">2. 二级缓存是SqlSessionFactory级别的</span><br></pre></td></tr></table></figure></li>
<li>二级缓存的使用<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">①在myabtis-config.xml全局的开启二级缓存</span><br><span class="line">&lt;settings&gt;</span><br><span class="line">    &lt;!-- 开启二级缓存 --&gt;</span><br><span class="line">    &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">&lt;/settings&gt;</span><br><span class="line"></span><br><span class="line">②SQL map映射文件中添加&lt;cache/&gt;</span><br><span class="line">&lt;cache/&gt;标签中属性的介绍:</span><br><span class="line">&lt;cache</span><br><span class="line">    eviction=&quot;FIFO&quot; </span><br><span class="line">    flushInterval=&quot;60000&quot; </span><br><span class="line">    size=&quot;512&quot; </span><br><span class="line">    readOnly=&quot;true&quot;/&gt;</span><br><span class="line">    </span><br><span class="line">eviction: 缓存的回收策略</span><br><span class="line">—&gt;LRU  – 最近最少使用的:移除最长时间不被使用的对象</span><br><span class="line">—&gt;FIFO – 先进先出: 按对象进入缓存的顺序来移除它们</span><br><span class="line">—&gt;SOFT – 软引用: 移除基于垃圾回收器状态和软引用规则的对象 </span><br><span class="line">—&gt;WEAK – 弱引用: 更积极地移除基于垃圾收集器状态和弱引用规则的对象</span><br><span class="line"></span><br><span class="line">flushInterval: 刷新间隔,默认不刷新，可以设置任意的正整数,毫秒数</span><br><span class="line"></span><br><span class="line">size: 引用数目-&gt;可以被设置为任意正整数,要记住你缓存的对象数目和你运行环境的可用内存资源数目,默认值是1024。</span><br><span class="line"></span><br><span class="line">readOnly: 是否只读默认是false-&gt;只读的缓存会给所有调用者返回缓存对象的相同实例。因此这些对象不能被修改。这提供了很重要的性能优势。可读写的缓存会返回缓存对象的拷贝(映射数据库的实体类必须实现序列化) 。这会慢一些,但是安全,因此默认是 false</span><br></pre></td></tr></table></figure></li>
<li>二级缓存设置成功的标志<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">日志中会出现缓存命中率，并且在每一次查询结束之后都要提交事务,否则二级缓存不会起作用,缓存命中率不会发生变化.</span><br><span class="line"></span><br><span class="line">Cache Hit Ratio [com.im.mapper.UserMapper]: 0.0</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="10-4-集成第三方缓存ehcache"><a href="#10-4-集成第三方缓存ehcache" class="headerlink" title="10.4 集成第三方缓存ehcache"></a>10.4 集成第三方缓存ehcache</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用二级缓存产品ehcache步骤</span><br></pre></td></tr></table></figure>
<ul>
<li>添加jar包或者依赖<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ehcache-2.10.4.jar</span><br><span class="line">mybatis-ehcache-1.0.0.jar</span><br></pre></td></tr></table></figure></li>
<li>添加ehcache产品配置文件ehcache.xml</li>
<li>配置Ehcache<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在SQL map 文件中配置&lt;cache/&gt;标签</span><br><span class="line"></span><br><span class="line"> &lt;cache type=&quot;org.mybatis.caches.ehcache.EhcacheCache&quot;&gt;</span><br><span class="line"> 	&lt;!-- 缓存创建以后，最后一次访问缓存，间隔多久缓存失效(单位s) --&gt;</span><br><span class="line"> 	&lt;property name=&quot;timeToIdleSeconds&quot; value=&quot;3600&quot;/&gt;</span><br><span class="line"> 	&lt;!-- 缓存创建日期起到失效时的时间间隔(单位s) --&gt;</span><br><span class="line"> 	&lt;property name=&quot;timeToLiveSeconds&quot; value=&quot;3600&quot;/&gt;</span><br><span class="line"> 	&lt;!-- 堆内存中缓存对象数(0:没有限制) --&gt;</span><br><span class="line"> 	&lt;property name=&quot;maxEntriesLocalHeap&quot; value=&quot;1000&quot;/&gt;</span><br><span class="line"> 	&lt;!-- 磁盘中的对象数,默认为0不限制 --&gt;</span><br><span class="line"> 	&lt;property name=&quot;maxEntriesLocalDisk&quot; value=&quot;1000000&quot;/&gt;</span><br><span class="line"> 	&lt;!-- 内存存储与释放策略(FIFO:先进先出,LFU:一直以来最少被使用的,LRU:最近最少使用的) --&gt;</span><br><span class="line"> 	&lt;property name=&quot;memoryStoreEvictionPolicy&quot; value=&quot;LRU&quot;/&gt;</span><br><span class="line"> &lt;/cache&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="第十一章-MYSQL分页"><a href="#第十一章-MYSQL分页" class="headerlink" title="第十一章 MYSQL分页"></a>第十一章 MYSQL分页</h2><h3 id="11-1-分页准备"><a href="#11-1-分页准备" class="headerlink" title="11.1 分页准备"></a>11.1 分页准备</h3><ul>
<li>操作数据库的接口代码<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 操作数据库表的接口</span><br><span class="line"> */</span><br><span class="line">public interface UserMapper &#123;</span><br><span class="line">	/*</span><br><span class="line">	 * 原生SQL分页</span><br><span class="line">	 * @Param:方法入参为多个时要使用此注解指定入参,否则mybatis表达式(#&#123;xxx&#125;)会找不到方法入参</span><br><span class="line">	 */</span><br><span class="line">	List&lt;User&gt; getUserPage(@Param(&quot;offset&quot;)int offset,@Param(&quot;pageSize&quot;)int pageSize);</span><br><span class="line">	/*</span><br><span class="line">	 * 分页插件分页</span><br><span class="line">	 */</span><br><span class="line">	List&lt;User&gt; getUserPage_();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>注册接口的xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.im.mapper.UserMapper&quot;&gt;</span><br><span class="line">	&lt;!-- 原生分页 --&gt;</span><br><span class="line">	&lt;select id=&quot;getUserPage&quot; resultType=&quot;user&quot;&gt;</span><br><span class="line">		SELECT * FROM user LIMIT #&#123;offset&#125;,#&#123;pageSize&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">	&lt;!-- 插件分页,pageHelper插件分页时,方法不需要传任何入参 --&gt;</span><br><span class="line">	&lt;select id=&quot;getUserPage_&quot; resultType=&quot;user&quot;&gt;</span><br><span class="line">		SELECT * FROM user</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="11-2-原生分页"><a href="#11-2-原生分页" class="headerlink" title="11.2 原生分页"></a>11.2 原生分页</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 原生分页</span><br><span class="line"> */</span><br><span class="line">@Test</span><br><span class="line">public void testGetUserPage() throws IOException &#123;</span><br><span class="line">	//加载外部属性资源文件</span><br><span class="line">	InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">	//创建SqlSessionFactory</span><br><span class="line">	SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">	//创建SqlSession</span><br><span class="line">	SqlSession session = sessionFactory.openSession();</span><br><span class="line">	</span><br><span class="line">	UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">	int pageNo=3;//当前页</span><br><span class="line">	int pageSize=2;//每页显示的条数</span><br><span class="line">	//mysql分页的第一个参数,转换公式</span><br><span class="line">	int offset=(pageNo-1)*pageSize;</span><br><span class="line">	List&lt;User&gt; page = mapper.getUserPage(offset, pageSize);</span><br><span class="line">	System.out.println(page);</span><br><span class="line">	//提交</span><br><span class="line">	session.commit();</span><br><span class="line">	//关闭会话</span><br><span class="line">	session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-3-分页插件-PageHelper"><a href="#11-3-分页插件-PageHelper" class="headerlink" title="11.3 分页插件(PageHelper)"></a>11.3 分页插件(PageHelper)</h3><ul>
<li>添加jar包或者依赖<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jsqlparser-0.9.5.jar</span><br><span class="line">pagehelper-5.1.2.jar</span><br></pre></td></tr></table></figure></li>
<li>在mybatis-config.xml中配置PageHelper<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置分页插件pageHelper --&gt;</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">	&lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;</span><br><span class="line">		&lt;!--</span><br><span class="line">			分页合理化参数，默认值为false。当该参数设置为 true 时， </span><br><span class="line">			pageNum&lt;=0 时会查询第一页， pageNum&gt;pages(超过总数时)， </span><br><span class="line">			会查询最后一页。默认false 时，直接根据参数进行查询</span><br><span class="line">		--&gt;</span><br><span class="line">		&lt;property name=&quot;reasonable&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;!-- 支持合法的参数化,设置这个属性以及下面的属性,可以设置方法的入参 --&gt;</span><br><span class="line">		&lt;property name=&quot;supportMethodsArguments&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;!-- 参数化的key值 --&gt;</span><br><span class="line">		&lt;property name=&quot;params&quot; value=&quot;pageNum=pageNumKey;pageSize=pageSizeKey;&quot;/&gt;</span><br><span class="line">	&lt;/plugin&gt;</span><br><span class="line">&lt;/plugins&gt;</span><br></pre></td></tr></table></figure></li>
<li>Junit单元测试<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * pageHelper分页</span><br><span class="line"> */</span><br><span class="line">@Test</span><br><span class="line">public void testGetUserPage_() throws IOException &#123;</span><br><span class="line">	//加载外部属性资源文件</span><br><span class="line">	InputStream in = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);</span><br><span class="line">	//创建SqlSessionFactory</span><br><span class="line">	SqlSessionFactory sessionFactory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">	//创建SqlSession</span><br><span class="line">	SqlSession session = sessionFactory.openSession();</span><br><span class="line">	UserMapper mapper = session.getMapper(UserMapper.class);</span><br><span class="line">	//在查询全部数据之前直接调用PageHelper.startPage(2, 2);方法进行分页</span><br><span class="line">	//注意不能再两个方法之间插入其他的代码方法入参为第一个:pageNo；第二个:pageSize</span><br><span class="line">	PageHelper.startPage(2, 2);</span><br><span class="line">	List&lt;User&gt; page_ = mapper.getUserPage_();</span><br><span class="line">	for (User user : page_) &#123;</span><br><span class="line">		System.out.println(user);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//提交</span><br><span class="line">	session.commit();</span><br><span class="line">	//关闭会话</span><br><span class="line">	session.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第十二章-mybatis和spring框架的整合"><a href="#第十二章-mybatis和spring框架的整合" class="headerlink" title="第十二章 mybatis和spring框架的整合"></a>第十二章 mybatis和spring框架的整合</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring + mybatis 框架整合</span><br><span class="line">整合步骤:</span><br></pre></td></tr></table></figure>
<ul>
<li>创建Java普通项目(因为没有页面所以不需要web项目)</li>
<li>添加jar包目或者maven依赖<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">commons-logging-1.2.jar</span><br><span class="line">druid-1.1.6.jar</span><br><span class="line">jsqlparser-0.9.5.jar</span><br><span class="line">log4j-1.2.17.jar</span><br><span class="line">mybatis-3.4.6.jar</span><br><span class="line">mybatis-spring-1.3.1.jar</span><br><span class="line">mysql-connector-java-5.1.7-bin.jar</span><br><span class="line">pagehelper-5.1.2.jar</span><br><span class="line">slf4j-api-1.7.25.jar</span><br><span class="line">slf4j-log4j12-1.7.25.jar</span><br><span class="line">spring-aop-4.3.10.RELEASE.jar</span><br><span class="line">spring-aspects-4.3.10.RELEASE.jar</span><br><span class="line">spring-beans-4.3.10.RELEASE.jar</span><br><span class="line">spring-context-4.3.10.RELEASE.jar</span><br><span class="line">spring-context-support-4.3.10.RELEASE.jar</span><br><span class="line">spring-core-4.3.10.RELEASE.jar</span><br><span class="line">spring-expression-4.3.10.RELEASE.jar</span><br><span class="line">spring-jdbc-4.3.10.RELEASE.jar</span><br><span class="line">spring-orm-4.3.10.RELEASE.jar</span><br><span class="line">spring-oxm-4.3.10.RELEASE.jar</span><br><span class="line">spring-test-4.3.10.RELEASE.jar</span><br><span class="line">spring-tx-4.3.10.RELEASE.jar</span><br></pre></td></tr></table></figure></li>
<li>创建jdbc.properties配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jdbc_user=root</span><br><span class="line">jdbc_password=root</span><br><span class="line">jdbc_url=jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8</span><br></pre></td></tr></table></figure></li>
<li>创建mybatis-config.xml配置⽂件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">  PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">  &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">	&lt;settings&gt;</span><br><span class="line">		&lt;!-- 开启二级缓存 --&gt;</span><br><span class="line">		&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;!-- 开启驼峰命名 --&gt;</span><br><span class="line">		&lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">	&lt;/settings&gt;</span><br><span class="line">	&lt;!-- 配置分页插件pageHelper --&gt;</span><br><span class="line">	&lt;plugins&gt;</span><br><span class="line">		&lt;plugin interceptor=&quot;com.github.pagehelper.PageInterceptor&quot;&gt;</span><br><span class="line">			&lt;!--</span><br><span class="line">				分页合理化参数，默认值为false。当该参数设置为 true 时， </span><br><span class="line">				pageNum&lt;=0 时会查询第一页， pageNum&gt;pages(超过总数时)， </span><br><span class="line">				会查询最后一页。默认false 时，直接根据参数进行查询</span><br><span class="line">			--&gt;</span><br><span class="line">			&lt;property name=&quot;reasonable&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">		&lt;/plugin&gt;</span><br><span class="line">	&lt;/plugins&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure></li>
<li>创建applicationContext.xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">	xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">	xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd</span><br><span class="line">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.3.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">	&lt;!-- 1.导入外部属性资源文件 --&gt;</span><br><span class="line">	&lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot; /&gt;</span><br><span class="line">	&lt;!-- 2.扫描需要扫描的包 --&gt;</span><br><span class="line">	&lt;context:component-scan base-package=&quot;com.sc&quot; /&gt;</span><br><span class="line">	&lt;!-- 3.配置数据库连接池 --&gt;</span><br><span class="line">	&lt;bean id=&quot;dataSource&quot; class=&quot;com.alibaba.druid.pool.DruidDataSource&quot; init-method=&quot;init&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line">		&lt;!-- 基本属性 url、user、password --&gt;</span><br><span class="line">		&lt;property name=&quot;url&quot; value=&quot;$&#123;jdbc_url&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;username&quot; value=&quot;$&#123;jdbc_user&#125;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;password&quot; value=&quot;$&#123;jdbc_password&#125;&quot; /&gt;</span><br><span class="line">		&lt;!-- 配置初始化大小、最小、最大 --&gt;</span><br><span class="line">		&lt;property name=&quot;initialSize&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;minIdle&quot; value=&quot;1&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;maxActive&quot; value=&quot;20&quot; /&gt;</span><br><span class="line">		&lt;!-- 配置获取连接等待超时的时间 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxWait&quot; value=&quot;60000&quot; /&gt;</span><br><span class="line">		&lt;!-- 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒 --&gt;</span><br><span class="line">		&lt;property name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;60000&quot; /&gt;</span><br><span class="line">		&lt;!-- 配置一个连接在池中最小生存的时间，单位是毫秒 --&gt;</span><br><span class="line">		&lt;property name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;300000&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;validationQuery&quot; value=&quot;SELECT &#x27;x&#x27;&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;testWhileIdle&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;testOnBorrow&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;testOnReturn&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">		&lt;!-- 打开PSCache，并且指定每个连接上PSCache的大小 --&gt;</span><br><span class="line">		&lt;property name=&quot;poolPreparedStatements&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;maxPoolPreparedStatementPerConnectionSize&quot; value=&quot;20&quot; /&gt;</span><br><span class="line">		&lt;!-- 配置监控统计拦截的filters --&gt;</span><br><span class="line">		&lt;property name=&quot;filters&quot; value=&quot;stat&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;!-- 4.配置SqlSessionFactory --&gt;</span><br><span class="line">	&lt;bean id=&quot;sqlSessionFactory&quot;</span><br><span class="line">		class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;typeAliasesPackage&quot; value=&quot;com.sc.entity&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;configLocation&quot; value=&quot;classpath:mybatis-config.xml&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;!-- 5.配置平台事务管理理器器 --&gt;</span><br><span class="line">	&lt;bean id=&quot;transactionManager&quot;</span><br><span class="line">		class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	&lt;!-- 6.开启基于注解的声明式事务 --&gt;</span><br><span class="line">	&lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot; /&gt;</span><br><span class="line">		&lt;!-- 7.注册mybatis接⼝口加⼊入到Spring IOC容器器中 --&gt;</span><br><span class="line">	&lt;bean class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;</span><br><span class="line">		&lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;sqlSessionFactory&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;basePackage&quot; value=&quot;com.sc.mapper&quot; /&gt;</span><br><span class="line">		&lt;property name=&quot;annotationClass&quot; value=&quot;org.springframework.stereotype.Repository&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></li>
<li>添加log4j.xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;</span><br><span class="line">&lt;log4j:configuration</span><br><span class="line">	xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;</span><br><span class="line">	&lt;appender name=&quot;STDOUT&quot;</span><br><span class="line">		class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;</span><br><span class="line">		&lt;param name=&quot;Encoding&quot; value=&quot;UTF-8&quot; /&gt;</span><br><span class="line">		&lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;ConversionPattern&quot;</span><br><span class="line">				value=&quot;%-5p %d&#123;MM-dd HH:mm:ss,SSS&#125; %m  (%F:%L) \n&quot; /&gt;</span><br><span class="line">		&lt;/layout&gt;</span><br><span class="line">	&lt;/appender&gt;</span><br><span class="line">	&lt;logger name=&quot;java.sql&quot;&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">	&lt;/logger&gt;</span><br><span class="line">	&lt;logger name=&quot;org.apache.ibatis&quot;&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">	&lt;/logger&gt;</span><br><span class="line">	&lt;root&gt;</span><br><span class="line">		&lt;level value=&quot;debug&quot; /&gt;</span><br><span class="line">		&lt;appender-ref ref=&quot;STDOUT&quot; /&gt;</span><br><span class="line">	&lt;/root&gt;</span><br><span class="line">&lt;/log4j:configuration&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第十三章-spring框架的单元测试"><a href="#第十三章-spring框架的单元测试" class="headerlink" title="第十三章 spring框架的单元测试"></a>第十三章 spring框架的单元测试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring和mybatis框架整合完成之后，需要测试整合是否成功,接下来需要进行测试,测试采用spring框架的spring-tx-4.3.10.RELEASE.jar 依赖进行单元测试.</span><br></pre></td></tr></table></figure>
<ul>
<li>使用mybatis上面的例子进行测试<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@ContextConfiguration(locations= &#123;&quot;classpath:applicationContext.xml&quot;&#125;)</span><br><span class="line">public class UserMapperTest &#123;</span><br><span class="line"></span><br><span class="line">	@Autowired</span><br><span class="line">	private UserMapper userMapper;</span><br><span class="line">	</span><br><span class="line">	@Test</span><br><span class="line">	public void test01() &#123;</span><br><span class="line">		List&lt;User&gt; users = userMapper.getUsers();</span><br><span class="line">		System.out.println(users);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="第十四章-mybatis映射MYSQL5-7新增的JSON数据类型"><a href="#第十四章-mybatis映射MYSQL5-7新增的JSON数据类型" class="headerlink" title="第十四章 mybatis映射MYSQL5.7新增的JSON数据类型"></a>第十四章 mybatis映射MYSQL5.7新增的JSON数据类型</h2><h3 id="14-1-mybatis-5-7-json数据类型介绍"><a href="#14-1-mybatis-5-7-json数据类型介绍" class="headerlink" title="14.1 mybatis 5.7 json数据类型介绍"></a>14.1 mybatis 5.7 json数据类型介绍</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MYSQL5.7的GA版本开始支持json格式的数据</span><br><span class="line">json格式有两种一种单个对象&#123;&#125;;另一种就是集合格式[]</span><br></pre></td></tr></table></figure>
<h3 id="14-2-Java对象和json数据的互通"><a href="#14-2-Java对象和json数据的互通" class="headerlink" title="14.2 Java对象和json数据的互通"></a>14.2 Java对象和json数据的互通</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">看看mybatis是怎么实现将Java的对象保存到数据库中的json数据格式,又怎么将数据库中的json数据格式查询出来保存成Java对象</span><br></pre></td></tr></table></figure>
<ul>
<li>创建数据库表<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tb_order(</span><br><span class="line">    `order_id` INT NOT NULL PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    `users` json NOT NULL,</span><br><span class="line">    `user` json NOT NULL</span><br><span class="line">)ENGINE=InnoDB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8;</span><br></pre></td></tr></table></figure></li>
<li>创建映射数据库表的Java实体类<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//测试数据库两种数据类型</span><br><span class="line">public class Order &#123;</span><br><span class="line"></span><br><span class="line">	private Integer orderId;</span><br><span class="line">    //[&#123;&quot;id&quot;:1001,&quot;name&quot;:&quot;李雷&quot;&#125;,&#123;&quot;id&quot;:1001,&quot;name&quot;:&quot;李雷&quot;&#125;]</span><br><span class="line">	private List&lt;User&gt; users;</span><br><span class="line">    //&#123;&quot;id&quot;:1001,&quot;name&quot;:&quot;李雷&quot;&#125;</span><br><span class="line">	private User user;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line">	// 用户ID</span><br><span class="line">	private Integer userId;</span><br><span class="line">	// 用户名</span><br><span class="line">	private String userName;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>创建自定义类型转换器进行JSON和POJO的转换</li>
<li><ul>
<li>集合类型处理器(处理集合数据) JsonArrayTypeHandler.java<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import java.sql.CallableStatement;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.type.BaseTypeHandler;</span><br><span class="line">import org.apache.ibatis.type.JdbcType;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line">import com.im.entity.User;</span><br><span class="line">/*</span><br><span class="line"> * 数组类型的相互转换</span><br><span class="line"> * JSON转换使用的是阿里巴巴的fastjson</span><br><span class="line"> */</span><br><span class="line">public class JsonArrayTypeHandler extends BaseTypeHandler&lt;List&lt;User&gt;&gt; &#123;</span><br><span class="line"></span><br><span class="line">	/*</span><br><span class="line">	 * 使用列名获取数据库中保存的json数据</span><br><span class="line">	 * 并将其数据类型转换成List集合</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; getNullableResult(ResultSet arg0, String arg1) throws SQLException &#123;</span><br><span class="line">		String string = arg0.getString(arg1);</span><br><span class="line">		return JSON.parseObject(string, List.class);</span><br><span class="line">	&#125;</span><br><span class="line">	/**</span><br><span class="line">	 * 使用索引获取数据库中保存的json数据</span><br><span class="line">	 * 并将其数据类型转换成List集合</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; getNullableResult(ResultSet arg0, int arg1) throws SQLException &#123;</span><br><span class="line">		String string = arg0.getString(arg1);</span><br><span class="line">		return JSON.parseObject(string, List.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 使用索引获取数据库中保存的json数据</span><br><span class="line">	 * 并将其数据类型转换成List集合</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public List&lt;User&gt; getNullableResult(CallableStatement arg0, int arg1) throws SQLException &#123;</span><br><span class="line">		String string = arg0.getString(arg1);</span><br><span class="line">		return JSON.parseObject(string,List.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 将集合的实体对象转换成JSON保存到数据库中</span><br><span class="line">	 */</span><br><span class="line">	@Override</span><br><span class="line">	public void setNonNullParameter(PreparedStatement arg0, int arg1, List&lt;User&gt; arg2, JdbcType arg3)</span><br><span class="line">			throws SQLException &#123;</span><br><span class="line">		arg0.setString(arg1, JSON.toJSONString(arg2));</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><ul>
<li>单个对象处理器(处理单个对象) JsonTypeHandler.java<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import java.sql.CallableStatement;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line"></span><br><span class="line">import org.apache.ibatis.type.BaseTypeHandler;</span><br><span class="line">import org.apache.ibatis.type.JdbcType;</span><br><span class="line"></span><br><span class="line">import com.alibaba.fastjson.JSON;</span><br><span class="line">import com.im.entity.User;</span><br><span class="line">/**</span><br><span class="line"> * 自定义类型处理器</span><br><span class="line"> * @author hushuang</span><br><span class="line"> * json转换使用阿里巴巴的fastjson</span><br><span class="line"> */</span><br><span class="line">public class JsonTypeHandler extends BaseTypeHandler&lt;User&gt; &#123;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public User getNullableResult(ResultSet arg0, String arg1) throws SQLException &#123;</span><br><span class="line">		return JSON.parseObject(arg0.getString(arg1), User.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public User getNullableResult(ResultSet arg0, int arg1) throws SQLException &#123;</span><br><span class="line">		return JSON.parseObject(arg0.getString(arg1), User.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public User getNullableResult(CallableStatement arg0, int arg1) throws SQLException &#123;</span><br><span class="line">		return JSON.parseObject(arg0.getString(arg1), User.class);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public void setNonNullParameter(PreparedStatement arg0, int arg1, User arg2, JdbcType arg3) throws SQLException &#123;</span><br><span class="line">		arg0.setString(arg1, JSON.toJSONString(arg2));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><ul>
<li>注册自定义类型转换器<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在mybatis-config.xml配置文件中注册</span><br><span class="line"></span><br><span class="line">&lt;typeHandlers&gt;</span><br><span class="line">	&lt;typeHandler handler=&quot;com.im.handler.JsonTypeHandler&quot; /&gt;</span><br><span class="line">	&lt;typeHandler handler=&quot;com.im.handler.JsonArrayTypeHandler&quot; /&gt;</span><br><span class="line">&lt;/typeHandlers&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>创建注解操作接口的xml配置文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.im.mapper.OrderMapper&quot;&gt;</span><br><span class="line">	&lt;!-- 测试插入 --&gt;</span><br><span class="line">	&lt;insert id=&quot;addOrder&quot; parameterType=&quot;order&quot;&gt;</span><br><span class="line">		INSERT INTO tb_order(users,user) </span><br><span class="line">		VALUES(#&#123;users,typeHandler=com.im.handler.JsonArrayTypeHandler&#125;,#&#123;user,typeHandler=com.im.handler.JsonTypeHandler&#125;)</span><br><span class="line">	&lt;/insert&gt;</span><br><span class="line">	&lt;!-- 测试查询 --&gt;</span><br><span class="line">	&lt;resultMap type=&quot;order&quot; id=&quot;orderMap&quot;&gt;</span><br><span class="line">		&lt;id property=&quot;orderId&quot; column=&quot;order_id&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;users&quot; column=&quot;users&quot; typeHandler=&quot;com.im.handler.JsonArrayTypeHandler&quot;/&gt;</span><br><span class="line">		&lt;result property=&quot;user&quot; column=&quot;user&quot; typeHandler=&quot;com.im.handler.JsonTypeHandler&quot;/&gt;</span><br><span class="line">	&lt;/resultMap&gt;</span><br><span class="line">	&lt;select id=&quot;getOrder&quot; resultMap=&quot;orderMap&quot;&gt;</span><br><span class="line">		SELECT * FROM tb_order WHERE order_id=#&#123;id&#125;</span><br><span class="line">	&lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></li>
<li>单元测试(略)</li>
</ul>
<hr>
<h2 id="第十五章-相关文档"><a href="#第十五章-相关文档" class="headerlink" title="第十五章 相关文档"></a>第十五章 相关文档</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mybatis中文官网地址:https://mybatis.org/mybatis-3/zh/index.html</span><br><span class="line">Druid中文官网地址:https://github.com/alibaba/druid/wiki/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98</span><br><span class="line">pageHelper官网地址:https://pagehelper.github.io/docs/howtouse/</span><br><span class="line">ehcache 官网地址:http://mybatis.org/ehcache-cache/</span><br></pre></td></tr></table></figure>
<hr>

    </div>

    
    
    <div>
	
		<div style="text-align:center;color: #ccc;font-size:14px; padding-top: 10px;">----------------本文结束<i class="fa fa-paw"></i>感谢您的阅读---------------</div>
	
</div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MyBatis/" rel="tag"># MyBatis</a>
              <a href="/tags/jdbc/" rel="tag"># jdbc</a>
              <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a>
              <a href="/tags/MySql/" rel="tag"># MySql</a>
              <a href="/tags/%E5%8A%A8%E6%80%81SQL/" rel="tag"># 动态SQL</a>
              <a href="/tags/%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C/" rel="tag"># 批量操作</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/07/02/Maven%E5%AE%9E%E7%94%A8%E6%94%BB%E7%95%A5/" rel="prev" title="maven笔记">
      <i class="fa fa-chevron-left"></i> maven笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/07/02/MyBatis-Plus%E5%85%A5%E9%97%A8(%E5%A4%9C%E6%B3%8A1.0%E7%89%88%E6%9C%AC)/" rel="next" title="MyBatis-Plus笔记">
      MyBatis-Plus笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-mybatis%E7%AE%80%E4%BB%8B"><span class="nav-text">第一章 mybatis简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-mybatis%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="nav-text">1.1 mybatis的历史</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-mybatis%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-text">1.2 mybatis是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-mybatis%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="nav-text">1.3 mybatis的优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-mybatis%E7%9A%84%E6%A0%B8%E5%BF%83%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99"><span class="nav-text">1.4 mybatis的核心文件编写</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%85%A5%E9%97%A8HelloWorld"><span class="nav-text">第二章 入门HelloWorld</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-mybatis%E5%B8%B8%E7%94%A8%E5%B1%9E%E6%80%A7%E9%85%8D%E7%BD%AE"><span class="nav-text">第三章 mybatis常用属性配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%98%A0%E5%B0%84%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B"><span class="nav-text">第四章 映射枚举类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0-SQL-map-%E6%B3%A8%E8%A7%A3-%E6%96%B9%E5%BC%8F%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-text">第五章 SQL map(注解) 方式进行数据库操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0-mybatis%E7%9A%84%E6%97%A5%E5%BF%97%E5%8A%9F%E8%83%BD"><span class="nav-text">第六章 mybatis的日志功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E6%97%A5%E5%BF%97%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="nav-text">6.1 日志的介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE"><span class="nav-text">6.2 日志配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-%E6%97%A5%E5%BF%97%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">6.3 日志的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E5%8A%A8%E6%80%81SQL"><span class="nav-text">第七章 动态SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E5%8A%A8%E6%80%81SQL%E7%AE%80%E4%BB%8B"><span class="nav-text">7.1 动态SQL简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E5%8A%A8%E6%80%81SQL%E4%BD%BF%E7%94%A8"><span class="nav-text">7.2 动态SQL使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-1-if%E8%AF%AD%E5%8F%A5-%E7%94%A8%E4%BA%8Ewhere%E5%AD%90%E5%8F%A5%E4%B9%8B%E5%90%8E%E4%BD%9C%E4%B8%BA%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="nav-text">7.2.1 if语句(用于where子句之后作为条件判断)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-2-if%E8%AF%AD%E5%8F%A5-%E7%94%A8%E4%BA%8E%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E4%BD%9C%E4%B8%BA%E5%85%A5%E5%8F%82%E5%88%A4%E6%96%AD"><span class="nav-text">7.2.2 if语句(用于更新语句作为入参判断)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-3-choose-when-otherwise"><span class="nav-text">7.2.3 choose (when, otherwise)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-2-4-foreach-%E5%A4%9A%E7%94%A8%E4%BA%8E%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="nav-text">7.2.4 foreach(多用于批量操作)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2"><span class="nav-text">第八章 高级查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%88%9B%E5%BB%BA-%E9%83%A8%E9%97%A8%E8%A1%A8-x2F-%E5%91%98%E5%B7%A5%E8%A1%A8"><span class="nav-text">8.1 数据库表创建(部门表&#x2F;员工表)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E7%9A%84%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="nav-text">8.2 创建映射数据库表的实体类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-%E5%88%9B%E5%BB%BA%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%98%A0%E5%B0%84%E5%99%A8%E6%8E%A5%E5%8F%A3"><span class="nav-text">8.3 创建操作数据库的映射器接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-%E5%88%9B%E5%BB%BA%E6%B3%A8%E5%86%8C%E6%8E%A5%E5%8F%A3%E7%9A%84XML%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">8.4 创建注册接口的XML配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-5-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%B1%BB"><span class="nav-text">8.5 单元测试类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2bug%E6%89%A9%E5%B1%95"><span class="nav-text">8.6 关联查询bug扩展</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B9%9D%E7%AB%A0-mybatis%E7%9A%84%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="nav-text">第九章 mybatis的懒加载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%87%92%E5%8A%A0%E8%BD%BD"><span class="nav-text">9.1 什么是懒加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E6%87%92%E5%8A%A0%E8%BD%BD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">9.2 懒加载的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E7%AB%A0-mybatis%E7%9A%84%E7%BC%93%E5%AD%98"><span class="nav-text">第十章 mybatis的缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-1-%E7%BC%93%E5%AD%98%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">10.1 缓存的优缺点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-2-mybatis%E7%9A%84%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="nav-text">10.2 mybatis的一级缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-3-mybatis%E7%9A%84%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98"><span class="nav-text">10.3 mybatis的二级缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-4-%E9%9B%86%E6%88%90%E7%AC%AC%E4%B8%89%E6%96%B9%E7%BC%93%E5%AD%98ehcache"><span class="nav-text">10.4 集成第三方缓存ehcache</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-MYSQL%E5%88%86%E9%A1%B5"><span class="nav-text">第十一章 MYSQL分页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#11-1-%E5%88%86%E9%A1%B5%E5%87%86%E5%A4%87"><span class="nav-text">11.1 分页准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-2-%E5%8E%9F%E7%94%9F%E5%88%86%E9%A1%B5"><span class="nav-text">11.2 原生分页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-3-%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6-PageHelper"><span class="nav-text">11.3 分页插件(PageHelper)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-mybatis%E5%92%8Cspring%E6%A1%86%E6%9E%B6%E7%9A%84%E6%95%B4%E5%90%88"><span class="nav-text">第十二章 mybatis和spring框架的整合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-spring%E6%A1%86%E6%9E%B6%E7%9A%84%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="nav-text">第十三章 spring框架的单元测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-mybatis%E6%98%A0%E5%B0%84MYSQL5-7%E6%96%B0%E5%A2%9E%E7%9A%84JSON%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">第十四章 mybatis映射MYSQL5.7新增的JSON数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#14-1-mybatis-5-7-json%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%BB%8B%E7%BB%8D"><span class="nav-text">14.1 mybatis 5.7 json数据类型介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-2-Java%E5%AF%B9%E8%B1%A1%E5%92%8Cjson%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BA%92%E9%80%9A"><span class="nav-text">14.2 Java对象和json数据的互通</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0-%E7%9B%B8%E5%85%B3%E6%96%87%E6%A1%A3"><span class="nav-text">第十五章 相关文档</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="夜泊1990"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">夜泊1990</p>
  <div class="site-description" itemprop="description">俱往矣,要多呲花,有多呲花</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">104</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">夜泊1990</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">687k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">10:25</span>
</div>
        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
